<HTML>
<HEAD>
<TITLE>fp_dong1.htm : Dongle Bashing ~ End of the dongle old aera</TITLE>
</HEAD>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="22"  WIDTH= "100%">
<TR><td></td>
<td>
<center><FONT SIZE="+2">Dongle Bashing</fonT><br>
        <FONT SIZE="+1">End of the dongle old aera ~ Dongles bye bye</fonT><bR>
or<bR>
"How a single +HCU reverser can easily blow a whole commercial sector out 
of history"

</center>
</td>
<td>
<center><a href="advanced.htm" tppabs="http://ftp.fravia.org/advanced.htm"><IMG SRC="xtranio.gif" tppabs="http://ftp.fravia.org/xtranio.gif" ALT="advanced" 
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a>
<br>
<font color=gray>Advanced</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
29 January 1998
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>
by 
<font size=+3>
Frog's print
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<a href="hcu98_3.htm" tppabs="http://ftp.fravia.org/hcu98_3.htm"><IMG SRC="hcu1.gif" tppabs="http://ftp.fravia.org/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a></td>
</tr>
<TR><td><center><a href="index.html" tppabs="http://ftp.fravia.org/index.html">
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0"
VSPACE="0" HSPACE="0"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 
reverse engineering</center> 
</center></TD>
<td BGCOLOR="898030">
<center>
<prE> </prE></center></td>
</TR>
<tr><td></td><td><i><center>
Oh my... the dongle old aera is finished. Out.<bR>
That's it, nothing more to add...  let's hope we get a new dongle aera to work on.<br>
Awesome essay. Frog's Print's incredible work should be printed (44 pages !) 
and sipped slowly, it's 
'cracking for conoisseurs'... fravia's vintage 1998 "grand reserve"!<br>Bye bye to all 
those that wanted to do some quick bucks selling hardware protections that 
were NOT protections at all. This is good, nobody will mourn the disappearing of 
smoke-sellers and bogus protectors.  Bye bye to all those that never 
cared to study assembly. This is good.  
Bye bye to all the creations of the poor programmers that 
blindly trusted commercial (and THEREFORE bogus) dongle 
protections to defend their valuable software instead of writing 
their own much more solide protections. Tsch Tsch.<br>
You had better read +ORC's students essays first... next time. 
And learn. And now don't come to the silly idea to blame Frog's Print...  
blame those dilettantes that have sold you smoke. Blame yourself. A little 
<a href="realicra.htm" tppabs="http://ftp.fravia.org/realicra.htm">reality cracking</a> would have done you 
some good, probably. Well, one never ends learning, does one? I would 
never have believed myself that (almost) all implementations of the 
dongle protections scheme were so 
stupid. Oh my, how low, how deep have the programmers fallen, since Micro$oft introduced its 
frilly-dizzy rattamazz operating system :-)<bR>Of course anyone of my readers 
could now just 'go shopping' and download, fetch or get hundred thousand 
dongle protected software programs, each one of them -incidentally- 
extremely expensive. DO NOT DO IT. You'll only stuff your already exploding harddisks to 
death for <u>nothing</u> and bore yourself to death.<br> See, you don't 
need to do it: that poor   
software won't disappear, nor it will go away. It will always be there. It wont 
be dongle protected any more after this, oh no, no, no :-)<bR> Yet, probably 
it will be as poorly 
protected as before by some other charlatans, smoke-selling some other 'infallible' protection 
scheme... people never learn. Unless they study. That's why you are here, my good reader, 
to master a difficult but POWERFUL art: reversing.<bR>
So don't steal the software that Frog's Print has now stripped naked. Look at those 
protection schemes, pathetically whining and sobbing under Frog's streng and mighty 
reversing blick. They wont be ever able to run away, the poor scared things.<bR> 
Of course -as it happens- this essay could be useful AGAINST THEFT.. for our 
underfunded public universities for instance, where 
(as I very well know) hardware dongles are regularly and phisycally stolen from their 
parallel ports (it's difficult to find a way to fest them there and students don't 
show any respect for public property any more, having being corrupted by the 'sacrality' of 
private gains and property)... so this 
essay may be a good reading, for all colleagues in the public sector, in order to protect 
against stupid vandalic theft their legally bought software 
as well :-)<bR>See: +crackers bring solutions for the good ones and ruin for the evil ones :-)
</i></center></td>
<td><center>
Also in:<br><bR>
<a href="project3.htm" tppabs="http://ftp.fravia.org/project3.htm"><IMG SRC="project3.gif" tppabs="http://ftp.fravia.org/project3.gif" ALT="+dongles" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Dongles</fonT><br><br>


<a href="progcor.htm" tppabs="http://ftp.fravia.org/progcor.htm"><IMG SRC="useful.gif" tppabs="http://ftp.fravia.org/useful.gif" ALT="+progcor" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR>
<font color=gray>Programmers<bR>Corner</fonT><br><br>

</center>
</td>
</tr>
<TR><td></td>
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(x)<B>Beginner</B> (x)<B>Intermediate</B> (x)<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- CORPUS  -->
<bR>

<I>This essay covers 14 dongle
protected softs: they <FONT COLOR="#000000">ALL can be FREELY DOWNLOADED
from their respective companies home pages / sites (see links below).</FONT></I>
<center><hr size=1>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont proabbly be changed) -->
Dongle Bashing
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
End of the dongle old aera ~ Dongles bye bye
   </FONT><BR>

<FONT SIZE="+1">"How a single +HCU reverser can easily blow a whole commercial sector out 
of history"</fonT><br><bR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->
Written by Frog's Print
   </FONT>
</center>
<!-- INTRODUCTION STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT></fonT></center><bR>
</td></tr></table>


<TT>Due to the huge Dongle/Security advertisement
campaign overrunning the Net those days (may be the biggest ever), mostly
from Aladdin (Hasp) and Rainbow Technologies (Sentinel), I decided to start
a first approach on this kind of protection.</TT>&nbsp;
<BR><TT>For this, I needed Dongle programs.&nbsp;</TT>&nbsp;
<BR><TT>-Q: Where the hell could we find Dongle protected softs??&nbsp;</TT>&nbsp;
<BR><TT>-A: On the Net!</TT>&nbsp;
<BR><TT>Yes, on the Net and for FREE. It's just like sharewares: you download
them, sometimes as the fully working update/new version or as a demo you
can test, and, if you send money to the author, you get a dongle instead
of a password.</TT>&nbsp;
<BR><TT>I fetched 14 of them, all different kind :</TT>&nbsp;
<BR><TT>From Hasp, Sentinel, DesKEY, Activator/Unikey to 'home-made' dongles,
simple or not, cheap or very expensive softs, small or overbloated, useless
or useful, running under Windows 32bit, 16bit or DOS, cracked them using
Live approach, Dead Listing or Zen cracking : every one to his taste!&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>After that, I can already give you my conclusion:&nbsp;</TT>&nbsp;
<BR><TT>What a disappointment! Only one soft out of 14 had an interesting
protection (<A HREF="#Micro Cap">MicroCap V</A>). So, dongles appear to
be a good "ready_to_use" protection but <B><U>they are NOT</U></B>. They
are as much complicated to program as they are to crack (sometimes even
more). If you are a programmer and want to use a dongle to protect your
soft, you must understand that you need to have real strong knowledge about
protection and programming. Otherwise just forget it (and you'll save money).&nbsp;</TT>&nbsp;
<BR>&nbsp;

<P><!-- PASTE HERE YOUR INTRODUCTION --><TT>So, Dongles could be a very
powerful and strong way to protect a soft...as long as the programmer willing
to utilize one knows how to use it. Unfortunately, most of them don't (note
that we are not talking about shareware programmers but professional guys!
) and are still using our "beloved" <I>Test eax,eax//jnz Bad_Guy</I> stupid
routine, thinking that they don't have to worry about the protection because
the dongle will take care of it (same old problem discussed so much often
here -: ). Some of them use ridiculous $5 shareware tricks to protect $4.000
professional softs (see <A HREF="#Vision">Vision XXL</A>) and, worse, others
just forgot to read the Dongle documentation manual shipped with their
hardware key (see <A HREF="#ABBCS31">ABBCS31</A>), you'll even find some
of the most amazingly stupid protections I can't find any words to describe
them (see <A HREF="#read_and_forget">DigiSHOW</A>). Too bad...specially
when those programs are available for free download on the Net.&nbsp;</TT>&nbsp;

<P><TT>Sometimes it may be useful to know which dongle is needed for the
program you want to crack (Aladdin's Hasp, Rainbow Technologies' Sentinel,
Dinkey, Everlock...) or, <B>very important</B> if you plan to use SoftICE
and some Breakpoints, the type of dongle (parallel or serial key, internal
or PCMCIA card, Network dongle...), sometimes you won't even have to care
about that. And, finally, in just few cases, you may not be able to crack
a program if you don't have the right dongle (but if you have the dongle
why should you crack it? -: ) or because the program is strongly encrypted
and/or uses too many anti-debugger and anti-w32dasm/IDAPro protections
(usually, those anti-crackers protections are not written by the programer
himself :- ).&nbsp;</TT>&nbsp;
<BR><TT>For this, never forget to read carefully the program's doc or HLP
files, to visit it's company home page (specially the "installation help"
or "FAQ" pages) to collect the maximum infos about the dongle needed. You'll
find them most of the time, but sometimes you may only find that the program
needs a "green" or "red" dongle. So don't forget to monitor the program
installation on your Hard Drive : for all the programs of this essay, during
their installation I used CleanSweep, WinDelete and TechFacts, all 3 programs
running at the same time. Then check for new .Vxd, .Drv, .Sys and .Dll
files in you windows(/system) or the programs directories. Do the same
the first time you'll run the program because it may use/create and hide
a lot of "~x34_m-!.sys" or similar strange named files anywhere on your
HD. If you can identify the Dongle manufacturer, then visit its WWW/FTP
sites, newsgroups, read newspaper articles about it and visit programmers'
tools retailers companies sites like <A HREF="tppmsgs/msgs4.htm#441" tppabs="http://www.sosdevelopers.com/">SOSdevelopers</A>
(if you can understand French), download their softs/demos (SOSdevelopers
<A HREF="tppmsgs/msgs4.htm#442" tppabs="http://www.sosdevelopers.com/scripts/ListeDemo.asp">download section</A>),
get their free catalogue where you'll find all products for programers
and the latest protections tools of the market (BTW, SOSdevelopers is probably
actually one of the rare place where you can still find SoftICE 3.01 and
all others Numega 14 days trial version products available for downloading
since Numaga lately removed their Download section from their WWW home
site -: ). And finally, if you plan to crack several dongle protected softs,
install and monitor the first one, crack it and then <B>delete</B> it before
installing the second one, third one... otherwise it'll be to messy and
complicated to monitor and crack.&nbsp;</TT>&nbsp;
<BR>&nbsp;

<P><TT>Here is now, for instance, some infos I found at <A HREF="tppmsgs/msgs4.htm#443" tppabs="http://www.aks.com/hasp">Aladdin
SoftWares</A> (Hasp/NetHasp dongles). They wrote this to help programers
to write a "good" protection for their dongle (blue comments are mine of
course!):</TT>&nbsp;
<BR>
<HR SIZE=1 WIDTH="100%">
<BR><I><TT><FONT SIZE=+0>Tips and Tricks for Maximum Protection (from Aladdin
SoftWares)</FONT>&nbsp;</TT></I>&nbsp;

<P><I><TT>The golden rule of HASP-based software protection is that the
protection system is only as secure as the routines that call the key and
decide whether to allow execution of the protected program. In other words,&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>since the hardware of HASP keys is too complicated to break
or duplicate, <U>hackers will usually try to trace the protection code
and eliminate the protection routines</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Emulating the Dongle by re-writing its main
routine is much funnier than boring tracing and patching (and sometimes
a lot easier, specially the Hasp protection routine! )</FONT></TT><I>&nbsp;</I>&nbsp;
<BR><I><TT>While we supply you with the best hardware and software protection
tools available, and while the HASP Envelope can by itself provide an excellent
protection for application programs, if possible, <U>you should enhance
your protection system by implementing the Application Programming Interface
(API) as well</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">If only they knew how to do it...</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT>Please keep in mind that while no single technique can defeat
every hacker, the more traps and safeguards you use, the more difficult
it will be to break your software. In order to achieve maximum protection
with HASP, we suggest you implement at least some of the procedures outlined
below:&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT><B>Issue as many calls as possible with many different Seed
Codes.</B>&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>The more calls and expected responses you use, <U>the more difficult
it will be to trace and remove them</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Boring yes, difficult not really.</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Perform logical divisions of the checking procedure.</B> Divide
the checking procedure, and if possible, spread it across your program
at far-away points.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>A logical division would be: calling, checking, and reacting
routines, each <U>situated in a different section of the program</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT><B>Hide parts of the checking code within a regular source code.</B>
For example, the calling routine can be <U>hidden within a general initialization
routine</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Easy to find with a BPIO 278/378</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Use complicated mathematical expressions.</B> In order to
confuse hackers, check for the Return Codes <U>using complicated mathematical
expressions</U>. For example, if you are expecting a Return Code which
equals 26387, incorporate an expression such as the one below to perform
the check:&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (ReturnCode1 -
7)/4 = (ExpectedReturnCode1 - 6602)/3&nbsp; then...</TT>&nbsp;</I>&nbsp;
<BR><I><TT>To further enhance your level of security, follow the same procedure
throughout your software for any mathematical constants used in implementing
your HASP software protection solution.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Yes, and add a beautiful jnz_Bad_Guy at the
end...</FONT><I>&nbsp;</I></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Use delayed reactions.</B> Do not react immediately to a checking
call. For example,do not test for a certain value and then issue an error
message if you do not like the result. If you do, the hacker will easily
understand what you are doing.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>It is better to store the value in a variable A, check A's value
a few subroutine calls later, and set a new variable B to say whether or
not you like it. Several calls after that, test the value of B, and only
then issue the error message.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>Force hackers to work backward to figure out how B got a certain
value and why the program fails because of that. The relation to the original
returned value should no longer be obvious.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">See above</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Perform check-sums.</B> Perform a check-sum on the program
to find out if it has been&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>tampered with. The most effective means to do this is with the
HASP Pro Kit.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>Otherwise, the simplest way to do so is to use the following
pattern:&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Calculate check-sum.</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Compare with correct
value.</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If the two do not
match,</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
issue an error message;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
otherwise, continue.</TT>&nbsp;</I>&nbsp;
<BR><I><TT>Unfortunately, this technique is vulnerable to several attacks.</TT></I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Bad luck!</FONT><I>&nbsp;</I>&nbsp;</TT>&nbsp;
<BR><TT>etc,etc...&nbsp;</TT>&nbsp;
<BR>
<HR SIZE=1 WIDTH="100%">
<BR><TT>To crack a dongle, you must first locate the protection you'll
have to crack. Any means are good:</TT>&nbsp;
<BR><TT>-searching in the program or its DLLs the main dongle routine (I
wrote my own <I>haspfind.com</I>&nbsp; that search a directory for the
file where the Hasp routine is located).</TT>&nbsp;
<BR><TT>-Bpio with softICE. It will always work (as long as you don't forget
to install the driver and, most of the time, reboot to load it) but you
may easily get stuck/lost deep inside complex routines.</TT>&nbsp;
<BR><TT>-Since most programs will issue an error message ("Dongle not found"...)
you may just have to BPX the MessageBoxA functions or all other similar
ones and find the cross-references.</TT>&nbsp;
<BR><TT>-Disassembling the file to find some "Check_If_Dongle_OK" exported
functions.</TT>&nbsp;

<P><TT>After that, there are different ways to crack it:&nbsp;</TT>&nbsp;
<BR><TT>1/Reverse engineering the dongle protection main routine in order
to emulate the dongle (see <A HREF="#ABBCS31">ABBCS31</A>).&nbsp;</TT>&nbsp;
<BR><TT>-This is very efficient specially if this routine is called dozens
or sometimes hundreds of times throughout the program (otherwise we would
have to patch all those cross-references!).&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>-With this method, you don't need to have the dongle driver loaded
(if you have 10 programs using different dongles, you'll need to have 10
different drivers always loaded).&nbsp;</TT>&nbsp;
<BR><TT>2/Patching some <I>Call</I>, <I>Test</I> or <I>jnz</I> instructions.&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>Not the most elegant method but useful if:&nbsp;</TT>&nbsp;
<BR><TT>-you don't know how the dongle protection routine works but you
quickly found the right <I>Bad_Guy </I>Flag.&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>-your program is to slow to start/run . Some overbloated EXE or
DLL will check for a dongle, dongle ID and Seed Code and, if they can't
find them, will check again and again before telling you that you don't
have the requested hardware key. For that reason, those programs may check
for the dongle for 15 or sometimes +30 seconds. This even happens sometimes
after you "emulated" the Dongle. A real waste of time! (see <A HREF="#WellCAD">WellCAD</A>).&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>3/Brute force approach:&nbsp;</TT>&nbsp;
<BR><TT>Close to the above solution, this one may be quite useful for program
that may react strangely when they are modified. This method just force
them to work the way you want (see <A HREF="#Ai Damage">Ai Damage</A>).</TT>&nbsp;
<BR><TT>4/You may use your own tips/findings like searching with Hiew the
bytes sequence 0xE900000000</TT>&nbsp;
<BR><TT>jmp Next_Instruction (see <A HREF="#OmniMark">OmniMark</A>).</TT>&nbsp;

<P><TT>In this essay, we'll just assume that you are familiar with cracking
because I won't give a lot of comments about all usual protections routines/tricks...
that don't have anything to see with the dongle protection nor will I spend
time to explain how to crack it when it will be quite obvious (most of
the time).&nbsp;&nbsp;&nbsp;</TT>&nbsp;

<P><TT>As said above, all programs cracked in this essay can be found and
download on their companies homepages (see links below).&nbsp;&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>You'll find plenty of dongle softs to download for free on the
Net. Just learn how to search and you'll see what I mean.</TT>&nbsp;
<PRE><TT>OK, now let's have some fun!</TT></PRE>

<!-- TOOLS REQUIRED STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT></fonT></center><bR>
</td></tr></table>


<P><B>Hiew 5.66</B>&nbsp;
<BR><B>SoftICE 3.22</B>&nbsp;
<BR><B>W32Dasm v6.x and W32Dasm8.5</B>&nbsp;
<BR><B>+IDA PRO v3.7</B>&nbsp;
<BR><B>A taste of Zen Cracking</B>&nbsp;
<!-- TARGET URL/FTP STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT></fonT></center><bR>
</td></tr></table>

<!-- DON'T FORGET TO PASTE HERE ALSO THE URL/FTP OF YOUR TARGET -->
<B>Targets'
url:</B>&nbsp;

<P><B>1) Micro-Cap V </B>(Spectrum SoftWare) <B><A HREF="tppmsgs/msgs4.htm#444" tppabs="http://www.cadlink.com/Download/down/mc52.zip">v2.01</A></B>
900Kb&nbsp;
<BR><B>2) Vision XL/XXL <A HREF="tppmsgs/msgs4.htm#445" tppabs="http://www.impuls-imaging.com/download.htm#Vision XL/XXL">v2.0</A></B>
(Impuls)&nbsp; 9.5Mb&nbsp;
<BR><B>3) ABBCS31<A HREF="tppmsgs/msgs4.htm#446" tppabs="http://www.klinkmann.com/download.htm"> v1.02</A>&nbsp;</B>
Klinkmann Automation Softs (DDE Servers)&nbsp; 420Kb&nbsp;
<BR><B>4) WellCAD v2.30</B> : <A HREF="tppmsgs/msgs4.htm#447" tppabs="ftp://ftp.alt.lu/pub/wellcad2.30/Windows95/Release.Full">Full
version</A>&nbsp; 10.5Mb or <A HREF="tppmsgs/msgs4.htm#448" tppabs="ftp://ftp.alt.lu/pub/wellcad2.30/Windows95/Release.Lite">Lite
version</A> 2.5Mb (similar but without help files and sample data files)&nbsp;
<BR><B>5) Label Craft <A HREF="tppmsgs/msgs4.htm#449" tppabs="http://www.axiworld.com/axtechpa/axaxicon.html">v6.01</A>
</B>(Axicon Softs)<B>&nbsp;</B> 1.2Mb&nbsp;
<BR><B>6) Ai Damage <A HREF="tppmsgs/msgs4.htm#450" tppabs="http://www.aitsuk.com/download.htm">v1.4</A>
</B>(Ai Training Services Ltd)&nbsp; 185Kb (requires the DK2 DESkey dongle
drivers -dk2wn95.386, dk2win32.dll...- if not installed on your system,
you can download them here: <A HREF="tppmsgs/msgs4.htm#451" tppabs="ftp://ftp.kcc.co.uk/pub/kcml/windk2drivers">Bdk2wn32.exe</A>
720Kb - read the essay for more infos-: )&nbsp;
<BR><B>7) Electro Chemistry <A HREF="tppmsgs/msgs4.htm#452" tppabs="http://www.sycopel.com/dload.htm">12
Nov.1997 version</A> </B>(Sycopel Scientific Ltd) 531Kb.&nbsp;
<BR><B>8) IPLab <A HREF="tppmsgs/msgs4.htm#453" tppabs="http://www.iplab.com/iplwinupdt.html">v1.7</A></B>&nbsp;
(Signal Analytics Corp.) 1.5Mb&nbsp;
<BR><B>9) DigiSHOW.vld <A HREF="tppmsgs/msgs4.htm#454" tppabs="http://www.future-software.co.uk/download.htm">v1.24</A></B>
1.59Mb&nbsp;
<BR><B>A) Axon Engineer Pro <A HREF="tppmsgs/msgs4.htm#455" tppabs="http://userpages.itis.com/aeonsoft/dlupgrad.htm">v2.11e</A></B>
2.09Mb&nbsp;
<BR><B>B) FTI/DOE <A HREF="tppmsgs/msgs4.htm#456" tppabs="http://www.finite-tech.com/download.html">v.2.3.1.4</A></B>
2.78Mb&nbsp;
<BR><B>C) S-Tagger for FrameMaker <A HREF="tppmsgs/msgs4.htm#457" tppabs="http://www.trados.com/prod/wbload.htm">v2.0</A></B>
1.32Mb&nbsp;
<BR><B>D) XinTianMa <A HREF="tppmsgs/msgs4.htm#458" tppabs="http://www.cjkware.com/update.html">C version</A>
</B>1.04Mb&nbsp;
<BR><B>E) OmniMark <A HREF="tppmsgs/msgs4.htm#459" tppabs="http://www.exoterica.com/develop/download/v3r1a/win95hsp/om31a.exe">V3R1a
Win95</A></B> 1.88Mb&nbsp;
<BR>&nbsp;</TD>
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT></fonT></center><bR>
</td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
unknown
except Micro-Cap V&nbsp; which used, in the past, the Sentinel dongle.
New version use the Hasp driver.

<!-- REAL ESSAY CORPUS STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT></center><bR>
</td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS! SHOULD NOT BLAST
     NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->
<A NAME="Micro Cap"></A><B><U><FONT SIZE=+2>Micro-Cap
V v2.10</FONT></U></B>
<BR><B>-Description:</B>
<BR>Integrated schematic editor and mixed analog/digital simulator that
provides an interactive sketch and simulate environment for electronics
engineers.
<BR><B>-OS:</B>
<BR>Win95 / NT(?)
<BR><B>-Protection:</B>
<BR>Dongle (parallel). Driver: <I>Hasp95.vxd</I> (c:\windows\system).
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected.
<BR>&nbsp;

<P><TT>Apparently, Micro-Cap V programmers are the only guys who understood
that the dongle will not do all the job. They tried to add some improvements
to the protection scheme:</TT>
<BR><TT>-Fake flags (Bad or Good_Guy).</TT>
<BR><TT>-Several flags hidden at different locations (using different registers).</TT>
<BR><TT>-Delayed reactions (calling, checking and reacting routines).</TT>
<BR><TT>-Mathematical expressions for checking the RetCodes (though they
could improve this part).</TT>
<BR><TT>-Several calls with different Seed Codes.</TT>
<BR><TT>...</TT>

<P><TT>This is the first Hasp dongle of this essay. I hope you read Zafer's
essay about the various hasp-dongle services because I will not explain
this again. However, I will show you the main Hasp routine from Micro-Cap
as it is just a little different from the one describe by Zafer, but it
works just the same:</TT>

<P><TT>:0054141A 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ebp</TT>
<BR><TT>:0054141B 89E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ebp, esp</TT>
<BR><TT>:0054141D 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pushad</TT>
<BR><TT>:0054141E 88C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov bh, al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service called</FONT></TT>
<BR><TT>:00541420 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edx</TT>
<BR><TT>:00541421 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop eax</TT>
<BR><TT>:00541422 8B5508&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx, dword
ptr [ebp+08]</TT>
<BR><TT>:00541425 8B750C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov esi, dword
ptr [ebp+0C]</TT>
<BR><TT>:00541428 8B3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov edi, dword ptr [esi]</TT>
<BR><TT>:0054142A 80FF32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp bh, 32</TT>
<BR><TT>:0054142D 7205&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jb 00541434</TT>
<BR><TT>:0054142F 8B7518&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov esi, dword
ptr [ebp+18]</TT>
<BR><TT>:00541432 8B06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [esi]</TT>
<BR><TT>:00541434 8B7510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov esi, dword
ptr [ebp+10]</TT>
<BR><TT>:00541437 8B36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, dword ptr [esi]</TT>
<BR><TT>:00541439 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ebp</TT>
<BR><TT>:0054143A E8B1D00000&nbsp;&nbsp; call 0054E4F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Haspreg</FONT></TT>
<BR><TT>:0054143F 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</TT>
<BR><TT>:00541440 8B7D0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+0C]</TT>
<BR><TT>:00541443 8907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], eax&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>:00541445 8B7D10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+10]</TT>
<BR><TT>:00541448 891F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], ebx&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode2</FONT></TT>
<BR><TT>:0054144A 8B7D14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+14]</TT>
<BR><TT>:0054144D 890F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], ecx&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode3</FONT></TT>
<BR><TT>:0054144F 8B7D18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+18]</TT>
<BR><TT>:00541452 8917&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], edx&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode3</FONT></TT>
<BR><TT>:00541454 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
popad</TT>
<BR><TT>:00541455 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</TT>
<BR><TT>:00541456 C21400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0014</TT>
<BR>&nbsp;

<P><TT>We will rewrite this routine in order to emulate the dongle because
there will be too may occurences to patch in this soft.</TT>

<P><TT>Running Micro-Cap will display the message box: '<I>Security Key
missing. Replace the key</I>'.</TT>
<BR><TT>With SoftICE, Bpx the above routine and run Micro-Cap.</TT>

<P><TT><U>The first break occures here</U>:</TT>

<P><TT>:00422C39 B801000000&nbsp;&nbsp; mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#1</FONT></TT>
<BR><TT>...</TT>
<BR><TT>:00422C5B E8BAE71100&nbsp;&nbsp; call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; IsHasp</FONT></TT>
<BR><TT>:00422C60 8B45F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov eax, dword
ptr [ebp-10]&nbsp;&nbsp; <FONT COLOR="#3333FF">; Store RetCode1 in EAX</FONT></TT>
<BR><TT>:00422C63 89EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esp, ebp</TT>
<BR><TT>:00422C65 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</TT>
<BR><TT>:00422C66 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</TT>
<BR><TT>:00422C67 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</TT>
<BR><TT>:00422C68 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00422C69 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>The caller:</TT>
<BR><TT>:00422AEC E82F010000&nbsp;&nbsp; call 00422C20</TT>
<BR><TT>:00422AF1 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check if OK</FONT></TT>
<BR><TT>:00422AF3 752D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422B22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>

<P><TT><FONT COLOR="#000000">Of course, the RetCode1 should be equal to
1.</FONT></TT>

<P><TT><FONT COLOR="#000000"><U>The second break</U>:</FONT></TT>

<P><TT><FONT COLOR="#000000">:00422E8D B805000000&nbsp;&nbsp; mov eax,
00000005</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#5</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E92 89542414&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [esp+14], edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E96 E87FE51100&nbsp;&nbsp; call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; HaspStatus</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E9B 8B442408&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [esp+08]&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Parallel Port # (RetCode3)</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E9F 8B7C2404&nbsp;&nbsp;&nbsp;&nbsp;
mov edi, dword ptr [esp+04]&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Type of Hasp (Retcode2)</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EA3 A37CF65500&nbsp;&nbsp; mov dword
ptr [0055F67C], eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EA8 83FF01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp edi, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Is it a Memo-Hasp?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EAB 740D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422EBA</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EAD B8FCFFFFFF&nbsp;&nbsp; mov eax,
FFFFFFFC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB2 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB5 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB6 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB7 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB8 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB9 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</FONT></TT>
<BR><TT><FONT COLOR="#000000">* Referenced by a (C)onditional Jump at Address:00422EAB</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EBA 31C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EBC 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EBF 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC0 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC1 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC2 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC3 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</FONT></TT>

<P><TT><FONT COLOR="#000000">No surprises yet: after checking if there
is a Hasp dongle connected, it checks its type (Memo-Hasp). It doesn't
care if it is a Memo-Hasp-1 or a Memo-Hasp-4 as Retcode1 is not verified.</FONT></TT>
<BR>Both

<P><TT><FONT COLOR="#000000"><U>The 3rd break</U>:</FONT></TT>

<P><TT><FONT COLOR="#000000">:00422C0E B802000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000002</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#2</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C13 E802E81100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; HaspCode</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C18 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C19 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1A 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1B C20400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret 0004</FONT></TT>

<P><TT><FONT COLOR="#000000">The caller:</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B5B E864000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00422BC4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B60 8B1424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov edx, dword ptr [esp]&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Store RetCode1 in Edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B63 81EACA190000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub edx, 000019CA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Edx-0x19CA</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B69 B905000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, 00000005</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B6E 89D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Store in Eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B70 C1FA1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sar edx, 1F</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B73 F7F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
idiv ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Eax/5 and store result in Eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B75 3D982D0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp eax, 00002D98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Is it correct?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B7A 7405&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422B81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; jmp over if OK</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B7C BE01000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Set Bad_Guy#1 Flag discreetly so that stupid</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; crackers will never find it!</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B81 817C24046DF60000&nbsp; cmp dword
ptr [esp+04],F66D </FONT><FONT COLOR="#3333FF">; Check RetCode2</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B89 0F8566FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422AF5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy#2 jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B8F 817C24086CD60000&nbsp; cmp dword
ptr [esp+08],D66C </FONT><FONT COLOR="#3333FF">; Check RetCode3</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B97 0F8558FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422AF5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy#2 jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B9D 817C240C973B0000&nbsp; cmp dword
ptr [esp+0C],3B97 </FONT><FONT COLOR="#3333FF">; Check RetCode4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422BA5 0F854AFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422AF5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy#2 jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422BAB EB80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 00422B2D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; JUMP if OK and make him believe everything</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; is fine...</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B2D 85F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test esi, esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; ...and check Bad_Guy#1 Flag!</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B2F 7507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422B38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy_Jump.</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>RetCodes 2, 3 and 4 are displayed in the code (0xF66D, 0xD66C,
0x3B97). To check the RetCode1, the program uses simple mathematical expressions
from offset 422B63 to offset 422B75.</TT>
<BR><TT>Finding the RetCode1 value is simple.</TT>
<BR><TT>We have:</TT>
<BR><TT>0x2D98 = (RetCode1 - 0x19CA) / 5</TT>
<BR><TT>So:</TT>
<BR><TT>RetCode1 = (0x2D98 * 5) + 0x19CA)</TT>
<BR><TT>RetCode1 = 0xFDC2</TT>
<BR><TT>You can see that if one of the 3 last RetCodes is wrong, it will
clearly send you on the Bad_Guy#2.</TT>
<BR><TT>But it will discreetly set the Bag_guy#1 flag (mov esi,1) if the
first RetCode is wrong and will go ahead as if everything was fine before
checking it later at offset 422B2F.</TT>
<BR><TT>&nbsp;</TT>

<P><TT><FONT COLOR="#000000"><U>The 4th break</U>:</FONT></TT>

<P><TT>This time, the program will read a block from the dongle, and check
if no error occured (RetCode3)</TT>

<P><TT>:00422CE2 B832000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov
eax, 00000032&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#32</FONT></TT>
<BR><TT>:00422CE7 31D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor edx, edx</TT>
<BR><TT>:00422CE9 E82CE71100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; ReadBlock</FONT></TT>
<BR><TT>:00422CEE 807D02EA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp byte ptr [ebp+02], EA&nbsp;&nbsp; <FONT COLOR="#3333FF">; Check correct
value</FONT></TT>
<BR><TT>:00422CF2 741F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422D13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp if OK</FONT></TT>
<BR><TT>:00422CF4 837D7A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp dword ptr [ebp+7A], 0&nbsp;&nbsp; <FONT COLOR="#3333FF">; Check RetCode3
(status Code)</FONT></TT>
<BR><TT>:00422CF8 7519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp if NOT correct as well</FONT></TT>
<BR><TT>:00422CFA B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy flag</FONT>&nbsp;<FONT COLOR="#3333FF">
but make it looks</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; like a Good_Guy Flag!</FONT></TT>
<BR><TT>:00422CFF 8DA582000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea esp, dword
ptr [ebp+82]</TT>
<BR><TT>..</TT>
<BR><TT>:00422D0A C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Back to caller</FONT></TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>:00422D13 8B457A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [ebp+7A] <FONT COLOR="#3333FF">; store status code in
Eax</FONT></TT>
<BR><TT>:00422D16 8DA582000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea esp, dword
ptr [ebp+82]</TT>
<BR><TT>..</TT>
<BR><TT>:00422D21 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Back to caller</FONT></TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>:00422B22 E831030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00422E58</TT>
<BR><TT>:00422B27 89C6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; store in esi as well</FONT></TT>
<BR><TT>:00422B29 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check if OK</FONT></TT>
<BR><TT>:00422B2B 7418&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422B45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; je Good_Guy</FONT></TT>
<BR><TT>:00422B2D 85F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test esi, esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check again to confuse...</FONT></TT>
<BR><TT>:00422B2F 7507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422B38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jne Bad_Guy</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>We could think that the <I>mov eax,1</I> is our Good_Guy because
right above, it checks the RetCode3 (equal to 0x0 if no error) and jump
if an error was returned.</TT>
<BR><TT>But it stores this RetCode into Eax (:422D13) and later will store
it into Esi too, and will check both registers to see if it's OK. It is
clear that, if the dongle was connected, the program should never reach
offset :422CF4.</TT>
<BR><TT>0xEA is probably a byte calculated somewhere depending on the dongle
RetCode (it is not RetCode1, 2, 3 or 4).&nbsp; To crack this will have
to store 0xEa into ebp+2 and to ensure that the RetCode3 will be equal
to 0x0.</TT>
<BR>&nbsp;

<P><TT>Now, Micro-Cap V seems to work fine but it still check for the dongle
depending on which key is pressed.</TT>
<BR><TT>&nbsp;</TT>

<P><TT><FONT COLOR="#000000"><U>The 5th break</U>:</FONT></TT>

<P><TT>Here, the program will check again Service#1 (IsHasp) but in another
location.</TT>

<P><TT><FONT COLOR="#000000"><U>The 6th break</U>:</FONT></TT>

<P><TT>Now it calls again Service 2.</TT>

<P><TT><FONT COLOR="#000000">:00422C0E B802000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000002</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C13 E802E81100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C18 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C19 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1A 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1B C20400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret 0004</FONT></TT>

<P><TT><FONT COLOR="#000000">The Caller:</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D6A E855FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00422BC4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D6F 6681FE8203&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 0382</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D74 7527&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D9D</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D76 813C24C7710000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 000071C7</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D7D 75C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D7F 817C2404935B0000&nbsp; cmp dword
ptr [esp+04], 00005B93</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D87 75BE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D89 817C2408E1BF0000&nbsp; cmp dword
ptr [esp+08], 0000BFE1</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D91 75B4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D93 817C240C900D0000&nbsp; cmp dword
ptr [esp+0C], 00000D90</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D9B 75AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D9D 6681FEE486&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 86E4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DA2 752B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422DCF</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DA4 813C248BF60000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 0000F68B</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DAB 759A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DAD 817C2404D3B40000&nbsp; cmp dword
ptr [esp+04], 0000B4D3</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DB5 7590&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DB7 817C2408FE0E0000&nbsp; cmp dword
ptr [esp+08], 00000EFE</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DBF 7586&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DC1 817C240CD43F0000&nbsp; cmp dword
ptr [esp+0C], 00003FD4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DC9 0F8578FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DCF 6681FE9907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 0799</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DD4 7537&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422E0D</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DD6 813C2411560000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 00005611</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DDD 0F8564FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DE3 817C2404BB6E0000&nbsp; cmp dword
ptr [esp+04], 00006EBB</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DEB 0F8556FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DF1 817C2408925C0000&nbsp; cmp dword
ptr [esp+08], 00005C92</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DF9 0F8548FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DFF 817C240C8EB60000&nbsp; cmp dword
ptr [esp+0C], 0000B68E</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E07 0F853AFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E0D 6681FE3E05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 053E</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E12 7537&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422E4B</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E14 813C24EB6F0000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 00006FEB</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E1B 0F8526FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E21 817C2404945D0000&nbsp; cmp dword
ptr [esp+04], 00005D94</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E29 0F8518FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E2F 817C24087D200000&nbsp; cmp dword
ptr [esp+08], 0000207D</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E37 0F850AFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E3D 817C240CCEAE0000&nbsp; cmp dword
ptr [esp+0C], 0000AECE</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E45 0F85FCFEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E4B 31C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E4D 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E50 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E51 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E52 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E53 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E54 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</FONT></TT>
<BR><TT><FONT COLOR="#000000">..</FONT></TT>
<BR><TT><FONT COLOR="#000000">..</FONT></TT>
<BR><TT>:00422D47 B8B13A0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00003AB1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT>:00422D4C 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</TT>
<BR><TT>:00422D4F 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00422D50 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</TT>
<BR><TT>:00422D51 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</TT>
<BR><TT>:00422D52 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00422D53 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Depending on the value of Esi ( 0x<FONT COLOR="#000000">0382, 0x86E4,
0x0799 or 0x053E) the program will check for different RetCodes (they all
are shown in the code) and if it's OK, will clear Eax (Good_Guy) otherwise
will make you jump to offset :422D47.</FONT></TT>
<BR><TT><FONT COLOR="#000000">If Esi has a different value (this shouldn't
happen) the program will get to the Good_Guy as well.</FONT></TT>
<BR><TT><FONT COLOR="#000000">To crack this, we will simply xor Ecx (on
the stack as it is saved there before the call to the Hasp routine) during
a call to Service 2 and therefore we will always reach our Good_Guy. Clearing
Ecx will not affect the call to Service 2 I described before this one as
it is unused (saved on the stack).</FONT></TT>
<BR>&nbsp;

<P><TT>There is a last break when exiting the program:</TT>

<P><TT><FONT COLOR="#000000"><U>The 7th break</U>:</FONT></TT>

<P><TT><FONT COLOR="#000000">:00422F38 B806000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000006</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F3D EBDC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 00422F1B</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F1B E8FAE41100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F20 8B45F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [ebp-08]</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F23 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F25 7418&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422F3F</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Here, the program just check if any error occured.&nbsp;</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>There are still few xrefs to the main Hasp routine (services 1,
6...) but it doesn't matter as we will 'emulate' the dongle and this will
work for thoses xrefs as well. However, one of them is a call to service
0x29 (HaspID) at offset :422BF6 that apparently the program doesn't reach.
We will not crack it.</TT>
<BR>&nbsp;

<P><TT>As there's not enough room in the main Hasp routine to write our
own one, we will do it mostly at offset :514E4F0 that is called by this
routine:</TT>
<BR><TT>All changes are shown in red:</TT>

<P><TT>.0514141A: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; ebp</TT>
<BR><TT>.0514141B: 89E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebp,esp</TT>
<BR><TT>.0514141D: 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pushad</TT>
<BR><TT>.0514141E: 88C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; bh,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; bh=Hasp Service called</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">05141420</FONT>: 80FF02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#2 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">05141423</FONT>: 0F8510000000&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00141439&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jump over if not</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">05141429</FONT>: 66C745240000&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; w,[ebp][00024],00000&nbsp; <FONT COLOR="#3333FF">;
otherwise clear Esi</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514142F</FONT>: E905000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .000141439&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Go ahead</FONT></TT>
<BR><TT>.05141434: 8B7510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; esi,[ebp][00010]<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; unused</FONT></TT>
<BR><TT>.05141437: 8B36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; esi,[esi]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; unused</FONT></TT>
<BR><TT>.05141439: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; back to original code</FONT></TT>
<BR><TT>.0514143A: E8B1D00000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;
.<U>00514E4F0</U>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; call our new routine</FONT></TT>
<BR><TT>.0514143F: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; ebp</TT>
<BR><TT>.05141440: 8B7D0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][0000C]</TT>
<BR><TT>.05141443: 8907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>.05141445: 8B7D10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][00010]</TT>
<BR><TT>.05141448: 891F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],ebx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode2</FONT></TT>
<BR><TT>.0514144A: 8B7D14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][00014]</TT>
<BR><TT>.0514144D: 890F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode3</FONT></TT>
<BR><TT>.0514144F: 8B7D18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][00018]</TT>
<BR><TT>.05141452: 8917&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode4</FONT></TT>
<BR><TT>&nbsp;</TT>

<P><TT><B><FONT COLOR="#000000">.</FONT></B><U><FONT COLOR="#CC0000">0514E4F0</FONT></U><B><FONT COLOR="#000000">:</FONT></B>
80FF01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;
bh,001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#1 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4F3</FONT>: 7505&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E4FA</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4F5</FONT>: B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4FA</FONT>: 80FF02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#2 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4FD</FONT>: 7519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E518</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4FF</FONT>: B8C2FD0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,00000FDC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E504</FONT>: BB6DF60000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebx,00000F66D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode2</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E509</FONT>: B96CD60000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,00000D66C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode3</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E50E</FONT>: BA973B0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edx,000003B97&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode4</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E513</FONT>: E925000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .00014E53D</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E518</FONT>: 80FF05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,005&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#5 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E51B</FONT>: 750C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E529</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E51D</FONT>: BB01000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebx,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode2</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E522</FONT>: B901000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode3</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E527</FONT>: EB14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .00014E53D</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E529</FONT>: 80FF06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,006&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#6 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E52C</FONT>: 740D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .00014E53B</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E52E</FONT>: 80FF32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,032&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#32 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E531</FONT>: 0F8504000000&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E53B</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E537</FONT>: C6451CEA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; b,[ebp][0001C],0EA&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
store our 0xEA</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E53B</FONT>: 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; ecx,ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; clear RetCode3 (NO error)</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E53D</FONT>: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; back to Hasp main routine</FONT></TT>
<BR><TT>.<FONT COLOR="#000000">0514E53E</FONT>: 8D3534FC5600&nbsp;&nbsp;&nbsp;&nbsp;
lea&nbsp;&nbsp;&nbsp; esi,[00056FC34]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; will never reach this part.</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Everything works quite well but it may be safer not to forget the
call to Service 0x29 that we didn't patch, just in case the program would
reach it one of these days...&nbsp;</TT>
<BR><TT>&nbsp;</TT>

<P>
<HR WIDTH="100%">

<P><A NAME="Vision"></A><B><U><FONT SIZE=+2>Vision XL/XXL v2.0</FONT></U></B>
<BR><B>-Description:</B>
<BR>High performance image processing and image analysis system.
<BR><B>-OS:</B>
<BR>Win95/NT
<BR><B>-Protection:</B>
<BR>Dongle (parallel or serial key). Driver: <I>Hardlock.vxd</I> (c:\windows\system).
<BR><B>-Misc.:</B>
<BR>Run as a DEMO if no dongle detected (Save, save as, copy disabled,
macros disabled after 30 program runs...).

<P><TT>Described as "seeing the invisible", this is a very sophisticated
and extremely expensive soft. For those reasons, we could only expect a
strong or at least, a good protection. Unfortunately, its protection is
really stupid, and then, the most amazing is that we won't even have to
care about the dongle to crack it!</TT>

<P><TT>During its installation, the program added the file <I>Hardlock.vxd</I>
and told us that we need to restart Windows before running it (to load
the dongle driver!).</TT>

<P><TT>Put a BPIO -H 378 with SoftICE and then run VisionXXL.</TT>
<BR><TT>Nothing happens!&nbsp;</TT> <TT>The program doesn't seem to check
the parallel port.&nbsp;</TT>

<P><TT>After a quick check at the huge documentation (25Mb is MS-Word format!),
I found this:</TT>
<BR><TT><FONT COLOR="#3333FF">"The security key can be reversed to be used
on a serial interface port...".</FONT></TT>
<BR><TT><FONT COLOR="#000000">I read that there are some lines to add to
your <I>Autoexec.bat</I> as well (SET HL_SEARCH=2f8s,...where 2f8 denotes
the IO address of the serial port,and s denotes the serial port. The ellipsis
... is used to indicate that you can check several ports one after the
other.).</FONT></TT>

<P><TT><FONT COLOR="#000000">OK, but let's just forget the dongle for now!</FONT></TT>
<BR><TT><FONT COLOR="#000000">Re-run the program. You'll get the big nagscreen/bitmap
telling you that the program is running in demo mode.</FONT></TT>
<BR><TT><FONT COLOR="#000000">As the "Save" feature is disabled, press
it in the target's toolbar. The following message box pops up:</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">"Sorry, this function is not available in
demo mode"</FONT></TT>
<BR><TT><FONT COLOR="#000000">Put a BPX MessageBoxA and press "Save" again.</FONT></TT>
<BR><TT><FONT COLOR="#000000">SoftICE pops. Press &lt;F11>, click 'OK'
and press &lt;F12> 3 times. You'll land here:</FONT></TT>
<BR>&nbsp;

<P><TT><FONT COLOR="#000000">.000CA432: E899820600&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp; .0001326D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Check if Full or Demo mode</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA437: 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test&nbsp;&nbsp; eax,eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA439: 740A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .0000CA445&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy_Jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA43B: E840EBF4FF&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp; .000018F80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Our MessageBoxA</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA440: E975040000&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .0000CA8BA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Bad_Guy_Exit</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA445: E8127D0B00&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp; .00018215C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Good_Guy_Go_Ahead</FONT></TT>

<P><TT><FONT COLOR="#000000">Those who are familiar with "disabled features"
cracking won't need to read my comments to understand this: this is a stupid
typical protection used so much often for this kind of program.</FONT></TT>
<BR>&nbsp;
<BR><TT><FONT COLOR="#000000">Let's have a look at the .0001326D0 routine:</FONT></TT>

<P><TT><FONT COLOR="#000000">001326D0: 8B81E8000000&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
eax,[ecx][0000000E8]</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326D6: 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test&nbsp;&nbsp; eax,eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326D8: 740D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .0001326E7&nbsp;</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326DA: 8B4804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[eax][00004]</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326DD: 85C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test&nbsp;&nbsp; ecx,ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326DF: 7406&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .0001326E7&nbsp;</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E1: B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,000000001&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Bad_Guy_Flag</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E6: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E7: 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; eax,eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy_Flag</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E9: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn</FONT></TT>

<P><TT><FONT COLOR="#000000">This routine is called as soon as you run
the program (to decide if it's a Demo or full working version) and each
time you'll press or try to use one of the disabled features.</FONT></TT>
<BR><TT><FONT COLOR="#000000">Obviously, patching the first <I>test eax,eax</I>
or changing the <I>mov eax,1</I> will be enough to crack this dongle protection.</FONT></TT>

<P>
<HR WIDTH="100%">
<BR>&nbsp;

<P><A NAME="ABBCS31"></A><B><U><FONT SIZE=+2>ABBCS31 v1.02</FONT></U></B>
<BR><B>-Description:</B>
<BR>DDE (Dynamic Data Exchange) Server allowing other Windows application
programs to access the data from the ABB Procontic CS31 automation system.
<BR><B>-OS:</B>
<BR>Win95/NT
<BR><B>-Protection:</B>
<BR>Dongle (parallel key). Driver: <I>Hasp95.vxd</I> (c:\windows\system).
<BR><B>-Misc.:</B>
<BR>Run as a time-limited DEMO if no dongle detected (will only run 1 hour).
<BR>&nbsp;

<P><TT>At the end of the installation setup, we get a "reboot to activate
HASP driver!" message. So we know where we are and where we going! The
program added the file <I>C:\Windows\System\Hasp95.vxd</I> and the following
line in the Registry: <I>'HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\HASP95'</I>.</TT>

<P><TT>With HIEW5.66, we can quickly find the Hasp main routine located
in the <I>Abbcs31.exe</I> file (193Kb).&nbsp;</TT>
<BR><TT>It starts at offset :00001AC9. Now we can BPX it with SoftICE (don't
forget to add 0x400000 to the offset from Hiew to SoftICE ):</TT>
<BR><TT>&nbsp;&nbsp; BPX 401AC9</TT>

<P><TT>Running ABBCS32, we'll get 3 breaks. Callers are:</TT>
<BR><TT>:401C9D</TT>
<BR><TT>:401D0C</TT>
<BR><TT>:401D8A</TT>

<P><TT>Here is the code (again from Hiew):</TT>

<P><TT>.00001C97: A1C40A4200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[000420AC4]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
eax=0x05</FONT></TT>
<BR><TT>.00001C9C: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; eax</TT>
<BR><TT>.00001C9D: E827FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">call&nbsp; .000001AC9</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Hasp routine service #5</FONT></TT>
<BR><TT>.00001CA2: 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; esp,024&nbsp;</TT>
<BR><TT>.00001CA5: 8B45CC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[ebp][-0034]</TT>
<BR><TT>.00001CA8: A3A0204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [0004220A0],eax</TT>
<BR><TT>.00001CAD: 837DD000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-0030],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Is it a Hasp-3 (RetCode2=0)?</FONT></TT>
<BR><TT>.00001CB1: 0F850C000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001CC3&nbsp;</TT>
<BR><TT>.00001CB7: C745C401000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],1&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Yes: Good_Guy_Flag</FONT></TT>
<BR><TT>.00001CBE: E907000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .000001CCA&nbsp;</TT>
<BR><TT>.00001CC3: C745C400000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Bad_Guy_Flag</FONT></TT>
<BR><TT>.00001CCA: 837DC400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Is it OK?</FONT></TT>
<BR><TT>.00001CCE: 0F8446000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .000001D1A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; No, send_Him_Away...</FONT></TT>
<BR><TT>.00001CD4: C705C40A420001000000&nbsp; mov&nbsp;&nbsp;&nbsp; d,[000420AC4],1&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; otherwise Go_Ahead</FONT></TT>
<BR><TT>...</TT>
<BR><TT>.00001D06: A1C40A4200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[000420AC4]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
eax=0x01</FONT></TT>
<BR><TT>.00001D0B: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; eax</TT>
<BR><TT>.00001D0C: E8B8FDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">call&nbsp; .000001AC9</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Hasp routine service #1</FONT></TT>
<BR><TT>.00001D11: 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; esp,024&nbsp;</TT>
<BR><TT>.00001D14: 8B45D4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[ebp][-002C]</TT>
<BR><TT>.00001D17: 8945C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [ebp][-003C],eax</TT>
<BR><TT>.00001D1A: 837DC400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Is it a Hasp Dongle (RetCode1=1)?</FONT></TT>
<BR><TT>.00001D1E: 0F84E7000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .000001E0B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump...</FONT></TT>
<BR><TT>.00001D24: C705C40A420002000000&nbsp; mov&nbsp;&nbsp;&nbsp; d,[000420AC4],2&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; otherwise Go_Ahead</FONT></TT>
<BR><TT>...</TT>
<BR><TT>.00001D84: A1C40A4200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[000420AC4]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
eax=0x02</FONT></TT>
<BR><TT>.00001D89: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; eax</TT>
<BR><TT>.00001D8A: E83AFDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">call&nbsp; .000001AC9</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Hasp routine service #2</FONT>&nbsp;</TT>
<BR><TT>.00001D8F: 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; esp,024&nbsp;</TT>
<BR><TT>.00001D92: C705C00A420000000000&nbsp; mov&nbsp;&nbsp;&nbsp; d,[000420AC0],0</TT>
<BR><TT>.00001D9C: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DA1: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DA4: 8B4DD4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-002C]</TT>
<BR><TT>.00001DA7: 398818204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][000422018],ecx<FONT COLOR="#3333FF">; Is RetCode1=0x7A17
?</FONT></TT>
<BR><TT>.00001DAD: 0F8551000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>.00001DB3: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DB8: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DBB: 8B4DD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-0030]</TT>
<BR><TT>.00001DBE: 39881C204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][00042201C],ecx<FONT COLOR="#3333FF">; Is RetCode2=0x768A
?</FONT></TT>
<BR><TT>.00001DC4: 0F853A000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT>&nbsp;</TT>
<BR><TT>.00001DCA: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DCF: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DD2: 8B4DCC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-0034]</TT>
<BR><TT>.00001DD5: 398820204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][000422020],ecx<FONT COLOR="#3333FF">; Is RetCode3=0x554C
?</FONT></TT>
<BR><TT>.00001DDB: 0F8523000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT>&nbsp;</TT>
<BR><TT>.00001DE1: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DE6: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DE9: 8B4DC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-0038]</TT>
<BR><TT>.00001DEC: 398824204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][000422024],ecx<FONT COLOR="#3333FF">; Is RetCode4=0xE6EB
?</FONT></TT>
<BR><TT>.00001DF2: 0F850C000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT>&nbsp;</TT>
<BR><TT>.00001DF8: C745C401000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],1&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Good_Guy_Flag</FONT></TT>
<BR><TT>.00001DFF: E907000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .000001E0B&nbsp;</TT>
<BR><TT>.00001E04: C745C400000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Bad_Guy_Flag</FONT></TT>
<BR><TT>.00001E0B: 837DC400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0</TT>
<BR><TT>.00001E0F: 0F8515000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E2A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Dongle_OK</FONT></TT>
<BR><TT>.00001E15: 837DC002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-0040],2&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
No_Dongle</FONT></TT>

<P><TT>This routine is <B>INCREDIBLY STUPID</B>!!</TT>
<BR><TT>As I said at the very beginning of this essay, the programmer just
forgot to read the Hasp documentation shipped with his dongle:</TT>
<BR><TT>Usually, you first check if there is a Hasp dongle connected to
the parallel port (Service #1) and then, if there is one, the type of Hasp
(Service #5).</TT>
<BR><TT>We can see here that the program check the type of Hasp before
verifying if there is a dongle connected.</TT>
<BR><TT>And so?</TT>
<BR><TT>The only problem is that we can see that ABBCS32 is expecting a
Hasp-3 dongle (RetCode2=0). But, after a call to Service #5, if you <U>don't
have any dongle connected</U> the RetCode2 will be equal to... 0x00 as
well!</TT>
<BR><TT>This just means that if you have the correct dongle or nothing
at all, the program will just assume that you have the right Hasp-3! Unbelievable...</TT>
<BR><TT>Fortunately, it checks Service #1 later.</TT>
<BR>&nbsp;

<P><TT>There are a lot of different ways to crack this crap (patching the
Bad_Guy_Flag...) but let's emulate the dongle by reverse engineering the
main Hasp routine again:</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Offsets changed are shown in <FONT COLOR="#CC0000">red</FONT> :</TT>

<P><TT>.00001AC9: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
ebp&nbsp;</TT>
<BR><TT>.00001ACA: 8BEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ebp,esp&nbsp;</TT>
<BR><TT>.00001ACC: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
eax&nbsp;</TT>
<BR><TT>.00001ACD: 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
ebx&nbsp;</TT>
<BR><TT>.00001ACE: 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
ecx&nbsp;</TT>
<BR><TT>.00001ACF: 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
edx&nbsp;</TT>
<BR><TT>.00001AD0: 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
edi&nbsp;</TT>
<BR><TT>.00001AD1: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
esi&nbsp;</TT>
<BR><TT>.00001AD2: 8B751C&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
esi,[ebp][0001C]&nbsp;</TT>
<BR><TT>.00001AD5: 8B3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[esi]&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AD7:</FONT> B900000000 mov&nbsp;&nbsp;&nbsp;
ecx,000000000&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Clear ecx.</FONT></TT>
<BR><TT><FONT COLOR="#000000">.00001ADC: </FONT>8B5D08&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebx,[ebp][00008]&nbsp; <FONT COLOR="#3333FF">; bl=Service
called.</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001ADF:</FONT> 80FB02&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bl,002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service #2?</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AE2:</FONT> 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001AF6&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AE4:</FONT> 66B8177A&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,07A17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#1</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AE8:</FONT> 66BB8A76&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
bx,0768A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#2</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AEC:</FONT> 66B94C55&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
cx,0554C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#3</FONT>&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF0:</FONT> 66BAEBE6&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
dx,0E6EB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#4</FONT>&nbsp;&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF4:</FONT> EB0F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .000001B05&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF6:</FONT> 80FB01&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bl,001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service #1?</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF9:</FONT> 7506&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001B01&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AFB:</FONT> 66B80100&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#1</FONT>&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AFF:</FONT> EB04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .000001B05&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001B01:</FONT> 33DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; ebx,ebx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Xor unused registers</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001B03:</FONT> 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; eax,eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; just in case.</FONT></TT>
<BR><TT>.00001B05: 8B7D1C&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][0001C]&nbsp; <FONT COLOR="#3333FF">; Back to original code.</FONT></TT>
<BR><TT>.00001B08: 8907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],eax&nbsp;</TT>
<BR><TT>.00001B0A: 8B7D20&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][00020]&nbsp;</TT>
<BR><TT>.00001B0D: 891F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],ebx&nbsp;</TT>
<BR><TT>.00001B0F: 8B7D24&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][00024]&nbsp;</TT>
<BR><TT>.00001B12: 890F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],ecx&nbsp;</TT>
<BR><TT>.00001B14: 8B7D28&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][00028]&nbsp;</TT>
<BR><TT>.00001B17: 8917&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],edx&nbsp;</TT>
<BR><TT>.00001B19: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
esi&nbsp;</TT>
<BR><TT>.00001B1A: 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
edi&nbsp;</TT>
<BR><TT>.00001B1B: 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
edx&nbsp;</TT>
<BR><TT>.00001B1C: 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
ecx&nbsp;</TT>
<BR><TT>.00001B1D: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
ebx&nbsp;</TT>
<BR><TT>.00001B1E: 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
eax&nbsp;</TT>
<BR><TT>.00001B1F: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
ebp&nbsp;</TT>
<BR><TT>.00001B20: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn&nbsp;</TT>
<BR>&nbsp;
<BR><TT>Abbcs31 is cracked.</TT>
<BR>
<HR WIDTH="100%">
<BR><A NAME="WellCAD"></A><B><U><FONT SIZE=+2>WellCAD v2.30</FONT></U></B>
<BR><B>-Description:</B>
<BR>Data repository, geophysical and geological reporting tool.
<BR><B>-OS:</B>
<BR>Win95/NT
<BR><B>-Protection:</B>
<BR>Dongle (parallel key). Driver: Hasp95.vxd
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected.
<BR>&nbsp;

<P><TT>Searching for the main Hasp routine, we easily find it at offset
:44D528 in the main program (wellcad.exe 1.42Mb). It has 2 X-refs and then,
the 14 X-refs (called several times) calling the Hasp services.</TT>
<BR><TT>Here are two of them:</TT>

<P><TT>:0049ECFE 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service #1</FONT>&nbsp;</TT>
<BR><TT>:0049ED00 E87B080000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049F580&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_It_A_Hasp_Dongle ?</FONT></TT>
<BR><TT>:0049ED05 8B442408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [esp+08]&nbsp;</TT>
<BR><TT>:0049ED09 8D4C2410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [esp+10]&nbsp;</TT>
<BR><TT>:0049ED0D 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dec eax&nbsp;</TT>
<BR><TT>:0049ED0E 8D54240C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea edx, dword ptr [esp+0C]&nbsp;</TT>
<BR><TT>:0049ED12 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp eax, 00000001&nbsp;</TT>
<BR><TT>:0049ED15 8D442414&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea eax, dword ptr [esp+14]&nbsp;</TT>
<BR><TT>:0049ED19 1BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sbb edi, edi&nbsp;</TT>
<BR><TT>:0049ED1B 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;</TT>
<BR><TT>:0049ED1C 8D44240C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea eax, dword ptr [esp+0C]&nbsp;</TT>
<BR><TT>:0049ED20 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ecx&nbsp;</TT>
<BR><TT>:0049ED21 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edx&nbsp;</TT>
<BR><TT>:0049ED22 8BCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, esi&nbsp;</TT>
<BR><TT>:0049ED24 F7DF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
neg edi&nbsp;</TT>
<BR><TT>:0049ED26 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;</TT>
<BR><TT>:0049ED27 6868200000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00002068&nbsp;</TT>
<BR><TT>:0049ED2C 6A02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service # 2</FONT>&nbsp;</TT>
<BR><TT>:0049ED2E E84D080000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049F580&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Get_Hasp_Code&nbsp;</FONT>&nbsp;</TT>
<BR><TT>:0049ED33 817C2408A5F70000&nbsp; cmp dword ptr [esp+08], 0000F7A5<FONT COLOR="#3333FF">;Is
RetCode1 OK ?</FONT></TT>
<BR><TT>:0049ED3B 7529&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:0049ED3D 817C240C8E420000&nbsp; cmp dword ptr [esp+0C], 0000428E<FONT COLOR="#3333FF">;Is
RetCode2 OK ?</FONT>&nbsp;</TT>
<BR><TT>:0049ED45 751F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:0049ED47 817C2410E54F0000&nbsp; cmp dword ptr [esp+10], 00004FE5<FONT COLOR="#3333FF">;Is
RetCode3 OK ?</FONT>&nbsp;</TT>
<BR><TT>:0049ED4F 7515&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_guy jump</FONT></TT>
<BR><TT>:0049ED51 817C24144E470000&nbsp; cmp dword ptr [esp+14], 0000474E<FONT COLOR="#3333FF">;Is
RetCode4 OK ?</FONT>&nbsp;</TT>
<BR><TT>:0049ED59 750B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:0049ED5B 83E701&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
and edi, 00000001&nbsp;</TT>
<BR><TT>:0049ED5E 8BC7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Set Good_Guy flag (eax=0x01)</FONT></TT>
<BR><TT>:0049ED60 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi&nbsp;</TT>
<BR><TT>:0049ED61 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi&nbsp;</TT>
<BR><TT>:0049ED62 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010&nbsp;</TT>
<BR><TT>:0049ED65 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;</TT>

<P><TT>* Referenced by a (C)onditional:0049ED3B(C), :0049ED45(C), :0049ED4F(C),
:0049ED59(C)&nbsp;</TT>
<BR><TT>:0049ED66 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor edi, edi&nbsp;</TT>
<BR><TT>:0049ED68 8BC7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy (clear eax)</FONT></TT>
<BR><TT>:0049ED6A 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi&nbsp;</TT>
<BR><TT>:0049ED6B 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi&nbsp;</TT>
<BR><TT>:0049ED6C 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010&nbsp;</TT>
<BR><TT>:0049ED6F C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>&nbsp;Let's crack it:</TT>
<BR><TT>:<FONT COLOR="#000000">0049ED66</FONT> 66B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ax,00001</TT>

<P><TT>Now if you run the program, it will ask you for your name and company
name to type in. Then, it will take about 12 seconds on a P233 before WellCAD
main window appears on your screen. Let's solve this problem.</TT>
<BR><TT>As there a too many checks and comparisons occuring even before
the calls to the dongle, with SoftICE, BPX the main Hasp routine (:44D528)
and try to find some interesting cross references that we'll lead us to
the fatal(s) <I>jnz_Bad_Guy.</I></TT>
<BR><TT>Without any problem, we find several of them but only 2 seem very
interesting:</TT>
<BR>&nbsp;

<P><TT>:004C01E7 E8684A0200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0713</TT>
<BR><TT>:004C01EC 8D8BC8000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ecx, dword
ptr [ebx+000000C8]</TT>
<BR><TT>:004C01F2 E829E6FDFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049E820&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Verify_Dongle&nbsp; (+ Misc routines)</FONT></TT>
<BR><TT>:004C01F7 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK ?</FONT></TT>
<BR><TT>:004C01F9 0F8455FDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je 004BFF54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:004C01FF 68C8030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 000003C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy go ahead</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C025F E8E4490200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MFC40.MFC40:NoName0711</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C0264 8D8BC8000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebx+000000C8]</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C026A E881F0FDFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049F2F0</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Verify_Dongle&nbsp; (+ Misc routines)</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C026F 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK ?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C0271 0F84DDFCFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 004BFF54</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C0277 8D4DC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebp-38]</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Good_Guy go ahead</FONT></TT>
<BR>&nbsp;

<P><TT>Just get rid of the two <I>Verify_Dongle</I> calls and replace them
with <I>mov eax,1</I>.&nbsp;</TT>

<P><TT>This will considerabely speed up the program (just 1 little second
to start) and the crack is done.&nbsp;</TT>
<BR><TT>OK, it seems very easy to crack but it takes longer that you may
think. The protection is not too bad: a lot of calls to sub-routines that
will call other sub-routines etc.. and then comparisons in one of them
with the conditional jump in another one... It may fool or confuse you
during a Live approach, but could not resist a good Dead listing.</TT>
<BR>
<HR WIDTH="100%">
<BR><B><U><FONT SIZE=+2>Label Craft v6.01</FONT></U></B>
<BR><B>-Description:</B>
<BR>Program for creating and editing all types of labels in the Microsoft
Windows environment..
<BR><B>-OS:</B>
<BR>Win3.xx/95 (16bit)
<BR><B>-Protection:</B>
<BR>Dongle (parallel key). Driver: none
<BR><B>-Misc.:</B>
<BR>Run as a&nbsp; DEMO if no dongle detected (Save and Save As are disabled,any
printed document will have: letters in text strings mixed up, numbers randomized,
graphics overcrossed).

<P><TT>This program doesn't require any external known driver. The dongle
protection is located in the main executable: <I>plabel.exe</I> (379Kb).</TT>
<BR><TT>Since this soft uses its own routines to check if there is a dongle,
let's have a quick look at its HLP file:</TT>
<BR><I><TT><FONT COLOR="#000000">'This software is protected with a hardware
key which must be plugged into the parallel printer port at the back of
your PC. Without the key LabelCraft runs in demo mode. The following message
is then shown when you choose Label Printing or Label Editing from the
main menu: 'Missing key lock! Continue as Demoversion?'.</FONT></TT></I>
<BR><TT>I have to say that this is not really helpful!</TT>
<BR><TT>Never mind, let's Zen crack:</TT>

<P><TT>With SoftICE:</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; BPIO -H 378</TT>

<P><TT>Run the program and a dialog box pops asking you to choose between
"Editing" or "Printing a label"</TT>
<BR><TT>Press "Editing" and SoftICE will break here:</TT>

<P><TT>.0001BFEA: EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
out&nbsp;&nbsp;&nbsp; dx,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;&nbsp;
Here</FONT></TT>
<BR><TT>.0001BFEB: EB00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .00001BFED&nbsp;</TT>
<BR><TT>.0001BFED: 8B0ECA3B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
cx,[03BCA]</TT>
<BR><TT>.0001BFF1: E2FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
loop&nbsp; .00001BFF1&nbsp;</TT>
<BR><TT>.0001BFF3: A17C09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ax,[0097C]</TT>
<BR><TT>.0001BFF6: 050200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; ax,00002</TT>
<BR><TT>This is the main routine that will checks your // port for the
dongle.</TT>
<BR><TT>To find the caller, it is very important to disable any BPIO before
pressing the &lt;F12> key otherwise SoftICE will break several times.</TT>
<BR><TT>With SoftICE:</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; BD *</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; &lt;F12> (press it 3 times)</TT>

<P><TT>We land here:</TT>
<BR><TT>.00015575: 9ADA543B55&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
001:054DA <FONT COLOR="#3333FF">; Check // port</FONT>&nbsp;</TT>
<BR><TT>.0001557A: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; sp,004</TT>
<BR><TT>.0001557D: 3D457F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; ax,07F45&nbsp; <FONT COLOR="#3333FF">; Is there a
dongle?</FONT></TT>
<BR><TT>.00015580: 7408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .00001558A <FONT COLOR="#3333FF">; Yes, jump...</FONT></TT>
<BR><TT>.00015582: 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc&nbsp;&nbsp;&nbsp; si<FONT COLOR="#3333FF">&nbsp;</FONT></TT>
<BR><TT>.00015583: 83FE03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; si,003</TT>
<BR><TT>.00015586: 7EC6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jle&nbsp;&nbsp; .00001554E</TT>
<BR><TT>.00015588: EB06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .000015590 <FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>.0001558A: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ax,00001&nbsp; <FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT>.0001558D: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; si</TT>
<BR><TT>.0001558E: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>.0001558F: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn</TT>

<P><TT>When I reached the <I>cmp ax,7F45</I> instruction, I saw in the
registers windows that ax=FFFF. I quickly patched the <I>je 1558A</I> with
<I>jumps 1558A</I>.</TT>
<BR><TT>The program seems to work well and we don't get any warning message
about the missing dongle. As the "Save" feature is disabled, I check the
main menu and...there are no "Save', "Save as" submenus!</TT>
<BR><TT>There is a screw loose somewhere.</TT>
<BR><TT>In fact, I just did a little mistake here: I said above to disable
the BPIO before pressing the &lt;F12> key and realized that I didn't re-enable
it again right after. When running a Dongle protected soft, it is necessary
to always have a BPIO enable, because the program may check at any time
the presence of the dongle.</TT>
<BR><TT>Exit Label Craft. Enable the BPIO until you reach the above code.
Disable it, press &lt;F12> 3 times and patch the <I>je 1558A</I> again.</TT>
<BR><TT>Now re-enable the BPIO and let the program run. SoftICE will pops
at offset .0001BFEA again.</TT>
<BR><TT>With SoftICE:</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; BD *</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; &lt;F12> (press it 3 times)</TT>

<P><TT>And we'll finally land here:&nbsp;</TT>
<BR><TT>.000147F7: 9ADA540748&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
001:054DA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Check
// port</FONT>&nbsp;</TT>
<BR><TT>.000147FC: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; sp,004&nbsp;</TT>
<BR><TT>.000147FF: 3D9E6F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; ax,06F9E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is there a dongle?</FONT>&nbsp;</TT>
<BR><TT>.00014802: 740B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .00001480F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Yes, jump...</FONT>&nbsp;</TT>
<BR><TT>.00014804: 9A58531248&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
001:05358&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; otherwise
disable "Save/Save as".</FONT></TT>
<BR><TT>.00014809: C706FC4E0100&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; w,[04EFC],00001
<FONT COLOR="#3333FF">; Set Bad_Guy_Flag.</FONT></TT>
<BR><TT>.0001480F: 9A9E53AC46&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
001:0539E&nbsp;</TT>
<BR><TT>.00014814: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ax,00001&nbsp;</TT>
<BR><TT>.00014817: 8D66FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea&nbsp;&nbsp;&nbsp; sp,[bp][-0002]&nbsp;</TT>
<BR><TT>.0001481A: 1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; ds&nbsp;</TT>
<BR><TT>.0001481B: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bp&nbsp;</TT>
<BR><TT>.0001481C: 4D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dec&nbsp;&nbsp;&nbsp; bp&nbsp;</TT>
<BR><TT>.0001481D: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retf&nbsp;</TT>
<BR><TT>Just make it always jump at offset .00014802.</TT>

<P><TT>Now, it may be a good idea to disasm the file to see if there is
any other similar check (another -slow- solution would be to enable the
BPIO and, with SoftICE, to test ALL features of the program -copy, printing...-
but I don't have that much time to waste -:). W32Dasm v6.xx should be fine
(plabel.exe is a 16bit file).</TT>

<P><TT>And here is what we find:</TT>

<P><TT>.00050461: 9ADA547704&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp; 001:054DA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check // port</FONT></TT>
<BR><TT>.00050466: 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; sp,004</TT>
<BR><TT>.00050469: 3D64D4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; ax,0D464&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is there a dongle?</FONT>&nbsp;</TT>
<BR><TT>.0005046C: 740B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .000050479&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Yes, jump otherwise...&nbsp;</FONT></TT>
<BR><TT>.0005046E: C706FC4E0100&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; w,[04EFC],00001
<FONT COLOR="#3333FF">; set Bad_Guy_Flag and</FONT></TT>
<BR><TT>.00050474: 9A58538C04&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
001:05358&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; add
garbages to the printing function...</FONT></TT>
<BR><TT>.00050479: 833EFC4E00&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;
w,[04EFC],000&nbsp;</TT>
<BR><TT>.0005047E: 7503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000050483&nbsp;&nbsp;&nbsp;&nbsp;</TT>
<BR><TT>.00050480: E90E01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .000050591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Go ahead if Dongle_OK.</FONT>&nbsp;</TT>
<BR><TT>.00050483: 9AFFFF0000&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
GETTICKCOUNT</TT>
<BR><TT>.00050488: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>
<BR><TT>.00050489: 9A1E852001&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
001:0851E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>
<BR><TT>Patching the <I>je .000050479</I> will fully crack this soft.</TT>

<P><TT>As we can see, there's nothing really amazing in this protection
but it is a bit more 'personal' and more discreet than the usual routines
used by important dongle manufacturer. It would be more complicated to
crack if some strong anti-softICE/disasm tricks would be added.</TT>

<P>&nbsp;
<HR WIDTH="100%">
<BR><A NAME="Ai Damage"></A><B><U><FONT SIZE=+2>Ai Damage v1.4</FONT></U></B>
<BR><B>-Description:</B>
<BR>Program to find the change in velocity of a vehicle from an analysis
of the damage caused
<BR><B>-OS:</B>
<BR>Win95/ <FONT COLOR="#000000">NT&nbsp;&nbsp;</FONT>
<BR><B>-Protection:</B>
<BR>Dongle (parallel key). Driver: DK2 DESkey
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected . Dongle license valid for 1 year.

<P><TT>If you didn't understand the program description here is another
one:</TT>
<BR><I><TT>"AiTS was founded to teach accident investigation, and to provide
software to assist accident investigators in their task.</TT></I>
<BR><TT><I>Ai Damage calculates changes in speed from the damage caused
to vehicles. The program not only uses the tried and tested Crash3 algorthims,
but also uses the principle of the conservation of linear momentum (in
two dimensions) to fully analyse your accident"</I>.</TT>
<BR><TT>To resume, this is just another crap I will erase from my HD right
after this essay.</TT>

<P><TT>This program requires the DK2 DESkey dongle driver (dk2wn95.386
for Win95) not available with the downloaded program (you can download
it here:&nbsp; <A HREF="tppmsgs/msgs4.htm#451" tppabs="ftp://ftp.kcc.co.uk/pub/kcml/windk2drivers">Bdk2wn32.exe</A>
720Kb -: ). If its installation failed, you can do it manually as per follows:</TT>
<BR><TT>Open 'system.ini'.Find the section of system.ini which is headed
[386Enh]. Insert the following line into this section:&nbsp;&nbsp;</TT>
<BR><TT>&nbsp; device=C:\AIDAMGE\DK2WN95.386&nbsp;</TT>
<BR><TT>If you changed the installation directory from C:\AIDAMAGE, you
should adjust the path in the above line accordingly.</TT>

<P><TT>A quick look at AiDamage doc gives us some infos about the protection:</TT>
<BR><I><TT>On the first time of starting, you will be requested to enter
a code.&nbsp; This code is needed before the dongle can be activated.&nbsp;
To obtain the code contact Ai Training Services on 01452 862798 and ask
for a code.&nbsp; You will also need to advise the operator of the number
quoted in the box. (Marked User code:)&nbsp;</TT></I>
<BR><I><TT>Type in the code supplied EXACTLY as given.&nbsp; Press 'OK'
and the dongle will be activated and Ai Damage will start. To activate
the dongle contact AiTS with the code displayed on the Enable Dongle dialog.&nbsp;
You will be given a return code which you should enter, exactly as quoted.&nbsp;
Once entered press OK and Ai Damage will start properly. If you fail
to enter the code as given, Ai Damage will not function.</TT></I>
<BR><I><TT>You should not need to enter any other codes until the dongle
is automatically de-activated at the expiry of your licence. Ai Damage
will function for three months following the expiry of the licence.&nbsp;
Any attempt beyond this date to start the program will fail., with the
display of this dialog.</TT></I>
<BR><I><TT>If you try and remove the dongle whilst Ai Damage is running,
then Ai Damage will detect this and close down.&nbsp; You may not have
any opportunity to save your data once the dongle has been removed.&nbsp;
Replacing the dongle will have no effect.&nbsp; You must re-start Ai Damage
and re-enter any of the lost data.&nbsp;</TT></I>
<BR><TT><I>On the expiry of the annual licence, the dongle will detect
this condition and cause Ai Damage to display this dialog box.&nbsp; You
need to follow the instructions on screen, and your dongle will be activated
for further use.</I>&nbsp;</TT>

<P><TT>As you can see, if you are working with AiDamage and then, by mistake,
remove or disconnect the dongle, ALL your work will be lost! Nice people...</TT>
<BR><TT>That's not all:</TT>
<BR><I><TT>Ai Damage will run under Windows NT.&nbsp; However it has not
been tested fully under NT and support with configuration of NT is not
provided as part of your licence agreement.</TT></I>
<BR><TT>And finally:</TT>
<BR><I><TT>It has been noticed that with some hardware / printer configurations
the presence of the dongle can cause corruption of the output to the printer.</TT></I>

<P><TT>What an encouragement to buy this soft!!</TT>

<P><TT>So, let's crack it "black &amp; blue" ; this will solve some of
those troubleshootings.&nbsp;</TT>

<P><TT>Run the program and you get the message box:&nbsp;</TT>
<BR><TT>DONGLE ERROR - Cannot find a valid dongle&nbsp;</TT>

<P><TT>Disasm the main exe file (<I>aidamage.exe</I> 341Kb)with W32dasm85.</TT>
<BR><TT>I simple search through the String Datas References will give us
all we need:</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>:0041257C FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp&nbsp;</TT>
<BR><TT>:00412582 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000008</TT>
<BR><TT>:00412585 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Driver_Loaded?</FONT></TT>
<BR><TT>:00412587 7425&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 004125AE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Jump if OK</FONT></TT>
<BR><TT>:00412589 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-10]</TT>
<BR><TT>:0041258C E8DF0E0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00413470&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "Dongle driver not loaded"</FONT></TT>
<BR><TT>:00412591 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;</TT>
<BR><TT>:00412593 0F8487FEFFFF&nbsp;&nbsp;&nbsp; je 00412420&nbsp;</TT>
<BR><TT>:00412599 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-10]&nbsp;</TT>
<BR><TT>:0041259C E8FF100000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 004136A0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "Unable to read license info"</FONT></TT>
<BR><TT>:004125A1 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;</TT>
<BR><TT>:004125A3 0F85C9000000&nbsp;&nbsp;&nbsp; jne 00412672&nbsp;</TT>
<BR><TT>:004125A9 E972FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Exit</FONT>&nbsp;</TT>
<BR><TT>:004125AE 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000&nbsp;</TT>
<BR><TT>:004125B0 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>
<BR><TT>:004125B6 E8A5030100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00422960&nbsp;</TT>
<BR><TT>:004125BB C745FC04000000&nbsp; mov [ebp-04], 00000004&nbsp;</TT>
<BR><TT>:004125C2 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>
<BR><TT>:004125C8 E809080100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0113&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Message Box:"Please Enter your password"</FONT>&nbsp;</TT>
<BR><TT>:004125CD 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "OK" pressed?</FONT>&nbsp;</TT>
<BR><TT>:004125D0 0F85AD040000&nbsp;&nbsp;&nbsp; jne 00412A83&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; if not=>Exit</FONT>&nbsp;</TT>
<BR><TT>:004125D6 682CC24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C22C&nbsp;</TT>
<BR><TT>:004125DB 8D4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebp-1C] <FONT COLOR="#3333FF">; Store our password</FONT></TT>
<BR><TT>:004125DE E833070100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0081&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Calculate correct password</FONT></TT>
<BR><TT>:004125E3 C645FC05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov
[ebp-04], 05&nbsp;</TT>
<BR><TT>:004125E7 8B459C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [ebp-64] <FONT COLOR="#3333FF">; Store correct password
in eax</FONT></TT>
<BR><TT>:004125EA 8B4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-1C] <FONT COLOR="#3333FF">; Store our password
in ecx</FONT></TT>
<BR><TT>:004125ED 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;</TT>
<BR><TT>:004125EE 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ecx&nbsp;</TT>
<BR><TT>:004125EF FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Compare both</FONT>&nbsp;</TT>
<BR><TT>:004125F5 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000008&nbsp;</TT>
<BR><TT>:004125F8 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Password_OK?</FONT>&nbsp;</TT>
<BR><TT>:004125FA 7428&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00412624&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Yes, jump and go ahead...&nbsp;</FONT></TT>
<BR><TT>:004125FC 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; otherwise...</FONT>&nbsp;</TT>
<BR><TT>:004125FE 6A30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000030&nbsp;</TT>
<BR><TT>...&nbsp;</TT>
<BR><TT>:00412600 6800C24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C200&nbsp;</TT>
<BR><TT>:0041261F E9FCFDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "Password incorrect, closing down"</FONT></TT>

<P><TT><FONT COLOR="#000000">A lot of interesting things are going on here.
I tried to nicely reververse engineer this routine but the program acted
so strangely that I prefer to use a brute force approach.</FONT></TT>
<BR><TT><FONT COLOR="#000000">What we are going to do is:</FONT></TT>
<BR><TT><FONT COLOR="#000000">-force the program to recognize the dongle
driver (even if it is not loaded)</FONT></TT>
<BR><TT><FONT COLOR="#000000">-Get rid of the "Enter your password" message
box.</FONT></TT>
<BR><TT><FONT COLOR="#000000">-Make it believe we typed a password and
pressed "OK"</FONT></TT>
<BR><TT><FONT COLOR="#000000">-Feed it with the right password</FONT></TT>
<BR><TT><FONT COLOR="#000000">-Force it to accept it</FONT></TT>

<P><TT><FONT COLOR="#000000">Changed offset are shown in </FONT><FONT COLOR="#CC0000">red</FONT><FONT COLOR="#000000">:</FONT></TT>

<P><TT>:0041257C FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp</TT>
<BR><TT>:00412582 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000008</TT>
<BR><TT><FONT COLOR="#CC0000">:00412585</FONT> 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Driver_Always_Loaded</FONT></TT>
<BR><TT>:00412587 7425&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 004125AE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Jump</FONT></TT>
<BR><TT>:00412589 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-10]</TT>
<BR><TT>:0041258C E8DF0E0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00413470&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>
<BR><TT>:00412591 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:00412593 0F8487FEFFFF&nbsp;&nbsp;&nbsp; je 00412420</TT>
<BR><TT>:00412599 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-10]</TT>
<BR><TT>:0041259C E8FF100000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 004136A0</TT>
<BR><TT>:004125A1 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:004125A3 0F85C9000000&nbsp;&nbsp;&nbsp; jne 00412672</TT>
<BR><TT>:004125A9 E972FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>
<BR><TT>:004125AE 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000</TT>
<BR><TT>:004125B0 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>
<BR><TT>:004125B6 E8A5030100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call 00422960&nbsp;</TT>
<BR><TT>:004125BB C745FC04000000&nbsp; mov [ebp-04], 00000004&nbsp;</TT>
<BR><TT>:004125C2 8D8D3CFFFFFF&nbsp;&nbsp;&nbsp; lea ecx, dword ptr [ebp+FFFFFF3C]&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">:004125C8</FONT> B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; No more Message Box</FONT></TT>
<BR><TT>:004125CD 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "OK" pressed</FONT>&nbsp;</TT>
<BR><TT>:004125D0 0F85AD040000&nbsp;&nbsp;&nbsp; jne 00412A83</TT>
<BR><TT>:004125D6 682CC24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C22C&nbsp;</TT>
<BR><TT>:004125DB 8D4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebp-1C] <FONT COLOR="#3333FF">; Store our password</FONT></TT>
<BR><TT>:004125DE E833070100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0081&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Calculate correct password</FONT></TT>
<BR><TT>:004125E3 C645FC05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov
[ebp-04], 05&nbsp;</TT>
<BR><TT>:004125E7 8B459C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [ebp-64] <FONT COLOR="#3333FF">; Store correct password
in eax</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">:004125EA</FONT> 8B4D9C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-64] <FONT COLOR="#3333FF">; Store correct password
in ecx</FONT></TT>
<BR><TT>:004125ED 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;</TT>
<BR><TT>:004125EE 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ecx&nbsp;</TT>
<BR><TT>:004125EF FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Compare both</FONT>&nbsp;</TT>
<BR><TT>:004125F5 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000008&nbsp;</TT>
<BR><TT>:004125F8 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Password_ALWAYS_OK</FONT></TT>
<BR><TT>:004125FA 7428&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00412624&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jump and go ahead.&nbsp;</FONT></TT>
<BR><TT>:004125FC 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Will never reach this part.</FONT></TT>
<BR><TT>:004125FE 6A30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000030&nbsp;</TT>
<BR><TT>...&nbsp;</TT>
<BR><TT>:00412600 6800C24200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push 0042C200&nbsp;</TT>
<BR><TT>:0041261F E9FCFDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp 00412420</TT>

<P><TT><FONT COLOR="#000000">There are still few enhancements to do because
running the program with these changes will give you the following message:</FONT></TT>
<BR><I><TT><FONT COLOR="#000000">"This dongle does not support AIDamage"</FONT></TT></I>

<P><TT><FONT COLOR="#000000">Back to W32dasm85 we quickly find the problem:</FONT></TT>

<P><TT><FONT COLOR="#000000">:0041293A FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00412940 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000008</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00412943 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00412945 7420&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00412967&nbsp;&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Yes, jump otherwise...</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00412947 8B4DF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-10]</FONT></TT>
<BR><TT><FONT COLOR="#000000">:0041294A E8F10B0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00413540</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "This dongle doesn't support..."</FONT></TT>
<BR>&nbsp;

<P><TT><FONT COLOR="#000000">We notice that the program is always checking
if the dongle is still present:</FONT></TT>

<P><TT><FONT COLOR="#000000">:0041450A FF1544EE4200&nbsp;&nbsp;&nbsp; MSVCRT40._mbscmp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414510 83C408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000008</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414513 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_Still_Connected?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414515 7511&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00414528</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414517 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414519 8B4DF4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, dword ptr [ebp-0C]</FONT></TT>
<BR><TT><FONT COLOR="#000000">:0041451C 64890D00000000&nbsp; mov dword
ptr fs:[00000000], ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414523 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414524 8BE5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esp, ebp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414526 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414527 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00414528 685CC64200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0042C65C</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "Dongle is no longer connected"</FONT></TT>

<P><TT><FONT COLOR="#000000">For those 2 checks, you just have to patch
both <I>test eax,eax</I>.</FONT></TT>
<BR>&nbsp;

<P><TT><FONT COLOR="#000000">Finally, I deeper look at the ASM listing
and you'll find some other error messages:</FONT></TT>

<P><I><TT><FONT COLOR="#000000">"Your dongle has not been updated"</FONT></TT></I>
<BR><TT><FONT COLOR="#000000">x-refs:</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00413C77</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00413F47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00413FF0</FONT></TT>

<P><I><TT><FONT COLOR="#000000">"Invalid enable code, closing down"</FONT></TT></I>
<BR><TT><FONT COLOR="#000000">x-refs:</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00413BFC</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00413C05</FONT></TT>

<P><I><TT><FONT COLOR="#000000">"Your licence has expired."</FONT></TT></I>
<BR><TT><FONT COLOR="#000000">X-Ref:</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00413966</FONT></TT>

<P><TT><FONT COLOR="#000000">I didn't patch those occurences as the program
worked well. I put some BPX at those offsets but SoftICE never broke (even
when changing the OS date). So I just assume the program may check inside
the dongle to see if the license has expired or not but since we forced
it to accept the dongle we may not need to patch them.</FONT></TT>
<BR><TT><FONT COLOR="#000000">Anyway, now you won't loose any data if you
have a dongle connected or not and you can print safely!</FONT></TT>
<BR>&nbsp;
<BR><TT>Note: you can remove the DK2 DESkey driver, it is not needed any
more.</TT>
<BR>
<HR WIDTH="100%">
<BR><B><U><FONT SIZE=+2>Electro Chemistry (12 Nov.1997 version)</FONT></U></B>
<BR><B>-Description:</B>
<BR>Electrochemistry Software.
<BR><B>-OS:</B>
<BR>Win3.xx/95
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: <I>Key.dll</I> (c:\windows\system).
<BR><B>-Misc.:</B>
<BR>Run as a DEMO if no dongle detected (Nagscreen, file and print operations
are disabled).

<P><TT>During its installation, this Visual Basic 3 soft added a <I>key.dll</I>
(18Kb) file to the <I>windows/system</I> directory.</TT>
<BR><TT>Though we could use Dodi's VB discompiler to disasm the main executable
(<I>ecprog.exe</I> 231Kb) and find all references to the dongle through
the source code, a live approach will be enough to get rid of the protection.</TT>

<P><TT>Running the program will display a Nagscreen:</TT>
<BR><I><TT>"The software key was not detected! The software will run in
demonstration mode only"</TT></I>

<P><TT>With SoftICE:</TT>
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; BPIO -H 378</TT>
<BR><TT>Run <I>ecprog.exe</I> and SoftICE pops. We are inside M<I>ake.dll</I>,
an Exported function from <I>Key.dll</I>.</TT>
<BR><TT>Press &lt;F12> 3 times, and you can't miss the dongle protection:</TT>
<BR>&nbsp;

<P><TT>.000105C8: E88EFE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp; .000010459&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check I/O</FONT></TT>
<BR><TT>.000105CB: 08C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp;
al,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>
<BR><TT>.000105CD: 7506&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jne&nbsp;&nbsp;
.0000105D5</TT>
<BR><TT>.000105CF: C646FF00&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; b,[bp][-0001],000&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Flag</FONT></TT>
<BR><TT>.000105D3: EB04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmps&nbsp;
.0000105D9</TT>
<BR><TT>.000105D5: C646FF01&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; b,[bp][-0001],001&nbsp;
<FONT COLOR="#3333FF">; Good_Guy_Flag</FONT></TT>
<BR><TT>.000105D9: 8A46FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
al,[bp][-0001]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Store Flag
in AL</FONT></TT>
<BR><TT>.000105DC: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>.000105DD: CA0C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retf&nbsp;&nbsp;
0000C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Back to caller</FONT></TT>

<P><TT>This routine is very important:</TT>
<BR><TT>You'll find it in most stupid dongle programs you'll have to crack,
so get familiar with it!</TT>

<P><TT>.0001004B: 9AFFFF0000&nbsp; call&nbsp;&nbsp; 001:004EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Call the above routine&nbsp;</FONT></TT>
<BR><TT>.00010050: 08C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp;
al,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy_flag set?</FONT></TT>
<BR><TT>.00010052: 7407&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je&nbsp;&nbsp;&nbsp;
.00001005B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>
<BR><TT>.00010054: C746FC0100&nbsp; mov&nbsp;&nbsp;&nbsp; w,[bp][-0004],00001
<FONT COLOR="#3333FF">; Full_Program_Flag</FONT></TT>
<BR><TT>.00010059: EB05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmps&nbsp;
.000010060</TT>
<BR><TT>.0001005B: 31C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;
ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Demo_Program_Flag</FONT></TT>
<BR><TT>.0001005D: 8946FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[bp][-0004],ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Bad_Guy
=> Xor AX</FONT></TT>
<BR><TT>.00010060: 8B46FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,[bp][-0004]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Good_Guy=>
AX=0x01</FONT></TT>
<BR><TT>.00010063: 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; di</TT>
<BR><TT>.00010064: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; si</TT>
<BR><TT>.00010065: 8D66FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;
sp,[bp][-0002]</TT>
<BR><TT>.00010068: 1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; ds</TT>
<BR><TT>.00010069: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bp</TT>
<BR><TT>.0001006A: 4D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dec&nbsp;&nbsp;&nbsp; bp</TT>
<BR><TT>.0001006B: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retf</TT>

<P><TT>If you disasm the DLL, you'll see that there is only 1 x-ref for
both routine: the program just checks for the dongle at the very beginning
but will not during its execution (but it will check the Full_Program/Demo_Program
flag).</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>You can patch the conditional jump at 00010052 or the first routine....
there are plenty of ways to do so.</TT>
<BR><TT>That's all for this dongle.</TT>
<BR>&nbsp;
<HR WIDTH="100%">

<P><B><U><FONT SIZE=+2>IPLab v1.7</FONT></U></B>
<BR><B>-Description:</B>
<BR>Scientific image analysis program.
<BR><B>-OS:</B>
<BR>Win95/NT4
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: <I>Sentinel.vxd</I>.
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected + SetUp password protected.

<P><TT>The Setup will prompt you for a password. Let's crack it:</TT>
<BR><TT>&nbsp;&nbsp; BPX DialogBoxParam</TT>
<BR><TT>Type in any password + &lt;Enter>.</TT>
<BR><TT>SoftICE pops:</TT>
<BR><TT>&nbsp;&nbsp; &lt;F11></TT>
<BR><TT>You'll get the "Incorrect Password" message. Press &lt;OK>.</TT>
<BR><TT>&nbsp;&nbsp; &lt;F12></TT>
<BR><TT>Now just look at the end of the routine:</TT>

<P><TT>xxxx:4494 B80100&nbsp;&nbsp; mov ax,0001&nbsp; <FONT COLOR="#3333FF">;
SetUP cancelled</FONT></TT>
<BR><TT>xxxx:4497 EB02&nbsp;&nbsp;&nbsp;&nbsp; jmp 449B</TT>
<BR><TT>xxxx:4499 33C0&nbsp;&nbsp;&nbsp;&nbsp; xor ax,ax&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Install program</FONT></TT>
<BR><TT>xxxx:449B 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop si</TT>
<BR><TT>xxxx:449C 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop di</TT>
<BR><TT>xxxx:449D C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; leave</TT>
<BR><TT>xxxx:449E CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret</TT>

<P><TT>Just patch the <I>mov ax,0001 </I>so that the Setup will think you
have typed the right password.</TT>

<P><TT>The program will be installed in the c:\IPLabDir directory (you
can't choose another destination directory).</TT>
<BR><TT>Running the main exe file <I>IPLab.exe</I> (1.22 Mb) will display:</TT>
<BR><TT>"KEY NOT FOUND"</TT>

<P><TT>WDasm it and here is what we find:</TT>

<P><TT>:0040D626 E815630200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00433940&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check_If_Dongle_OK</FONT></TT>
<BR><TT>:0040D62B 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:0040D62D 7516&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0040D645&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT>:0040D62F 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push esi</TT>
<BR><TT>:0040D630 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push esi</TT>
<BR><TT>:0040D631 68A8C64B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 004BC6A8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "Key not found" + Exit</FONT></TT>
<BR><TT>:0040D636 E8A5E50400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MFC40.MFC40:NoName0029</TT>
<BR><TT>:0040D63B C7837C02000002000000&nbsp;&nbsp;&nbsp; mov dword ptr
[ebx+0000027C], 2</TT>
<BR><TT>:0040D645 8D4DC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebp-40]</TT>

<P><TT>Just make it always jump.</TT>

<P><TT>When running, the program will check is the key is still plugged
in:</TT>

<P><TT>* Referenced by a CALL at Addresses :0043379C, :0043BCD1, :0043BD23,
:0043BD75, :0043BDC3, :0044CF15</TT>
<BR><TT>:00433AB0 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000</TT>
<BR><TT>:00433AB2 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000</TT>
<BR><TT>:00433AB4 6894E14B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 004BE194&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "Key Missing"</FONT>&nbsp;</TT>

<P><TT>It is called by 6 different routines. Here is just the first one
of them (they all use the same following piece of code):</TT>

<P><TT>:00433787 E894830000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0043BB20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check // port</FONT></TT>
<BR><TT>:0043378C 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>
<BR><TT>:0043378E 740C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 0043379C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>:00433790 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cdq</TT>
<BR><TT>:00433791 B907000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, 00000007</TT>
<BR><TT>:00433796 F7F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
idiv ecx</TT>
<BR><TT>:00433798 85D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test edx, edx</TT>
<BR><TT>:0043379A 7425&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 004337C1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>
<BR><TT>* Referenced by (C)onditional Jump :0043378E</TT>
<BR><TT>:0043379C E80F030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00433AB0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "Key Missing" + Exit</FONT></TT>
<BR><TT>:004337A1 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000</TT>
<BR><TT>:004337A3 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001</TT>

<P><TT>This routine check the parallel port by calling offset :0043BB20.
The 5 other similar ones call 4 different routines:</TT>

<P><TT>1) 0043BB20&nbsp;</TT>
<BR><TT>2) 0043BC20</TT>
<BR><TT>3) 0043BB60&nbsp;</TT>
<BR><TT>4) 0043BBB0&nbsp;</TT>

<P><TT>Now let's see those 4 routines that call the Sentinel driver:</TT>
<BR><TT>1)</TT>
<BR><TT>:0043BB20 A1B4094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [004C09B4]&nbsp;</TT>
<BR><TT>:0043BB25 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
movsx eax, word ptr [eax]&nbsp;</TT>
<BR><TT>:0043BB28 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cdq&nbsp;</TT>
<BR><TT>:0043BB29 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, edx&nbsp;</TT>
<BR><TT>:0043BB2B 2BC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub eax, edx&nbsp;</TT>
<BR><TT>:0043BB2D 8B15BC094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov edx, dword ptr [004C09BC]&nbsp;</TT>
<BR><TT>:0043BB33 8BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, eax&nbsp;</TT>
<BR><TT>:0043BB35 0FBF02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
movsx eax, word ptr [edx]&nbsp;</TT>
<BR><TT>:0043BB38 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cdq&nbsp;</TT>
<BR><TT>:0043BB39 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, edx&nbsp;</TT>
<BR><TT>:0043BB3B 2BCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub ecx, edx&nbsp;</TT>
<BR><TT>:0043BB3D 03C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add ecx, eax&nbsp;</TT>
<BR><TT>:0043BB3F 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0043BB53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Make it always jump 43BB41</FONT></TT>
<BR><TT>:0043BB41 FF1580794C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MSVCRT40.rand&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">
; Good_Guy</FONT></TT>
<BR><TT>:0043BB47 8D0CC500000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [8*eax+00000000]&nbsp;</TT>
<BR><TT>:0043BB4E 2BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub ecx, eax&nbsp;</TT>
<BR><TT>:0043BB50 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, ecx</TT>
<BR><TT>:0043BB52 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;</TT>
<BR><TT>* Referenced by a jump:0043BB3F(C)&nbsp;</TT>
<BR><TT>:0043BB53 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor ecx, ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT>:0043BB55 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, ecx&nbsp;</TT>
<BR><TT>:0043BB57 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;</TT>

<P><TT>2)</TT>
<BR><TT>:0043BC20 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ebx</TT>
<BR><TT>:0043BC21 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push esi</TT>
<BR><TT>:0043BC22 668B5C240C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov bx, word ptr [esp+0C]</TT>
<BR><TT>:0043BC27 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edi</TT>
<BR><TT>:0043BC28 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor edi, edi</TT>
<BR><TT>...</TT>
<BR><TT>:0043BC54 85FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test edi, edi</TT>
<BR><TT>:0043BC56 750E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0043BC66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Make it always jump 43BC58&nbsp;</FONT></TT>
<BR><TT>:0043BC58 FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; Good_Guy</FONT></TT>
<BR><TT>:0043BC5A 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc eax</TT>
<BR><TT>:0043BC5B 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</TT>
<BR><TT>:0043BC5C 8BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, eax</TT>
<BR><TT>:0043BC5E 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:0043BC5F C1E003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl eax, 03</TT>
<BR><TT>:0043BC62 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:0043BC63 2BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub eax, ecx</TT>
<BR><TT>:0043BC65 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>* Referenced by a (C)onditional Jump :0043BC56</TT>
<BR><TT>:0043BC66 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT>:0043BC68 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</TT>
<BR><TT>:0043BC69 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:0043BC6A 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:0043BC6B C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>

<P><TT>3)</TT>
<BR><TT>:0043BB60 A1B8094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [004C09B8]</TT>
<BR><TT>:0043BB65 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
movsx eax, word ptr [eax]</TT>
<BR><TT>...</TT>
<BR><TT>:0043BB7F A1B0094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [004C09B0]</TT>
<BR><TT>:0043BB84 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
movsx eax, word ptr [eax]</TT>
<BR><TT>:0043BB87 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cdq</TT>
<BR><TT>:0043BB88 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, edx</TT>
<BR><TT>:0043BB8A 2BCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub ecx, edx</TT>
<BR><TT>:0043BB8C 03C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add ecx, eax</TT>
<BR><TT>:0043BB8E 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0043BBA2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Make it always jump 43BB90</FONT></TT>
<BR><TT>:0043BB90 FF1580794C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MSVCRT40.rand&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">
; Good_Guy</FONT></TT>
<BR><TT>:0043BB96 8D0CC500000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [8*eax+00000000]</TT>
<BR><TT>:0043BB9D 2BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub ecx, eax</TT>
<BR><TT>:0043BB9F 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, ecx</TT>
<BR><TT>:0043BBA1 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>* Referenced by a (C)onditional Jump :0043BB8E(C)</TT>
<BR><TT>:0043BBA2 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor ecx, ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT>:0043BBA4 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, ecx</TT>
<BR><TT>:0043BBA6 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>

<P><TT>4)</TT>
<BR><TT>:0043BBB0 A1B4094C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [004C09B4]</TT>
<BR><TT>:0043BBB5 0FBF00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
movsx eax, word ptr [eax]</TT>
<BR><TT>:0043BBB8 99&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cdq</TT>
<BR><TT>...</TT>
<BR><TT>:0043BBF6 33C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, edx</TT>
<BR><TT>:0043BBF8 2BCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub ecx, edx</TT>
<BR><TT>:0043BBFA 03C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add ecx, eax</TT>
<BR><TT>:0043BBFC 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0043BC10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Make it always jump 43BBFE&nbsp;</FONT></TT>
<BR><TT>:0043BBFE FF1580794C00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MSVCRT40.rand&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">
; Good_Guy</FONT></TT>
<BR><TT>:0043BC04 8D0CC500000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [8*eax+00000000]</TT>
<BR><TT>:0043BC0B 2BC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub ecx, eax</TT>
<BR><TT>:0043BC0D 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, ecx</TT>
<BR><TT>:0043BC0F C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>* Referenced by a (C)onditional Jump :0043BBFC(C)</TT>
<BR><TT>:0043BC10 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor ecx, ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT>:0043BC12 8BC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, ecx</TT>
<BR><TT>:0043BC14 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>

<P><TT>That was just another stupid protection which didn't need any dongle.
A simple 'password protected' program or a good .Reg/.Key file would have
done the same (and would have save money to those programers -:).</TT>

<P>
<HR WIDTH="100%">

<P><A NAME="read_and_forget"></A><B><U><FONT SIZE=+2>DigiSHOW.vld v1.7</FONT></U></B>
<BR><B>-Description:</B>
<BR>Virtual Laser Disk program.
<BR><B>-OS:</B>
<BR>Win95
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: <I>DK47wn32.dll</I>
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected.
<BR>&nbsp;

<P><TT>Disasm the main exe (<I>vld.exe</I> 145Kb).</TT>
<BR><TT>There're no words to describe the following; <B>just read it and
forget it</B>.</TT>
<BR><TT>&nbsp;&nbsp;</TT>

<P><TT>:00405E4F E8ECD7FFFF&nbsp;&nbsp;&nbsp; call 00403640&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Get_That_stupid_dongle_driver</FONT></TT>
<BR><TT>:00405E54 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp
eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>
<BR><TT>:00405E57 0F8515010000&nbsp; jne 00405F72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Jump if not</FONT></TT>
<BR><TT>:00405E5D 8B44243C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov eax, dword
ptr [esp+3C]</TT>
<BR><TT>:00405E61 8B4C2430&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx, dword
ptr [esp+30]&nbsp;</TT>
<BR><TT>...&nbsp;</TT>
<BR><TT>* Referenced by a (C)onditional Jump :00405E57(C)&nbsp;</TT>
<BR><TT>:00405F72 6A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; "The DigiSHOW.vld key</FONT>&nbsp;</TT>
<BR><TT>:00405F79 68F8824100&nbsp;&nbsp;&nbsp; push 004182F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; has not been found"</FONT>&nbsp;</TT>
<BR><TT>&nbsp;&nbsp;</TT>

<P><TT>And now, ladies and gentlemen, <B>THE </B>CALL :&nbsp;</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>* Referenced by a (C)onditional Jump :00405E57</TT>
<BR><TT>:00403640 81EC08080000&nbsp; sub esp, 00000808&nbsp;</TT>
<BR><TT>:00403646 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push esi&nbsp;</TT>
<BR><TT>:00403647 33F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor esi, esi&nbsp;</TT>
<BR><TT>:00403649 E8C4490000&nbsp;&nbsp;&nbsp; <FONT COLOR="#CC0000">DK47wn32.DK47DriverInstalled&nbsp;
</FONT><FONT COLOR="#3333FF">; No comments</FONT>&nbsp;</TT>
<BR><TT>:0040364E 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp
eax, 00000001&nbsp;</TT>
<BR><TT>:00403651 7549&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0040369C&nbsp;</TT>
<BR><TT>:00403653 E8B4490000&nbsp;&nbsp;&nbsp; <FONT COLOR="#CC0000">DK47wn32.FindDK47&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; No comments</FONT>&nbsp;</TT>
<BR><TT>:00403658 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp
eax, 00000001&nbsp;</TT>
<BR><TT>:0040365B 753F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0040369C&nbsp;</TT>
<BR><TT>:0040365D 8D442404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea eax, dword
ptr [esp+04]&nbsp;</TT>
<BR><TT>:00403661 6806080000&nbsp;&nbsp;&nbsp; push 00000806</TT>
<BR><TT>:00403666 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax</TT>
<BR><TT>:00403667 6A3B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0000003B</TT>
<BR><TT>:00403669 6A06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000006</TT>
<BR><TT>:0040366B 6A1E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0000001E</TT>
<BR><TT>:0040366D E894490000&nbsp;&nbsp;&nbsp; <FONT COLOR="#CC0000">DK47wn32.DK47ReadRandomNumbers
</FONT><FONT COLOR="#3333FF">; No comments</FONT></TT>
<BR><TT>:00403672 B847040000&nbsp;&nbsp;&nbsp; mov eax, 00000447</TT>
<BR><TT>:00403677 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor ecx, ecx</TT>
<BR><TT>:00403679 8A4C0404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov cl, byte ptr
[esp+eax+04]</TT>
<BR><TT>:0040367D 03F1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esi, ecx</TT>
<BR><TT>:0040367F 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc eax</TT>
<BR><TT>:00403680 3D06080000&nbsp;&nbsp;&nbsp; cmp eax, 00000806</TT>
<BR><TT>:00403685 7CF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jl 00403677</TT>
<BR><TT>:00403687 81FECAFE0100&nbsp; cmp esi, 0001FECA</TT>
<BR><TT>:0040368D 750D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0040369C</TT>
<BR><TT>:0040368F B801000000&nbsp;&nbsp;&nbsp; mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Guess?</FONT></TT>
<BR><TT>:00403694 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00403695 81C408080000&nbsp; add esp, 00000808</TT>
<BR><TT>:0040369B C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>

<P><TT>* Referenced by a (C)onditional Jump :00403651, :0040365B, :0040368D</TT>
<BR><TT>:0040369C 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Guess here too?</FONT>&nbsp;</TT>
<BR><TT>:0040369E 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi&nbsp;</TT>
<BR><TT>:0040369F 81C408080000&nbsp; add esp, 00000808&nbsp;</TT>
<BR><TT>:004036A5 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;</TT>
<BR><TT>&nbsp;&nbsp;</TT>

<P><TT>Everything is here. I would insult you if I explained how to crack
this crap, so I will not.&nbsp;</TT>
<BR><TT>&nbsp;&nbsp;</TT>
<BR><TT>The Help/About menu displays:</TT>

<P><I><TT>DESIN &amp; CODING:</TT></I>
<BR><I><TT>Chris Fulton</TT></I>
<BR><I><TT>GRAPHICS:</TT></I>
<BR><I><TT>Chris Fulton</TT></I>
<BR><I><TT>MANUAL:</TT></I>
<BR><I><TT>Chris Fulton</TT></I>

<P><TT>Sorry, Chris, but you're an asshole: keep working on the Manual,
but for God's sake, just forget the Coding!&nbsp;</TT>
<BR><TT>&nbsp;</TT>
<BR>
<HR WIDTH="100%">

<P><B><U><FONT SIZE=+2>Axon Engineer Pro v2.11e</FONT></U></B>
<BR><B>-Description:</B>
<BR>Neurocellular modeling tool.
<BR><B>-OS:</B>
<BR>DOS/Win3.xx/Win95
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: <I>Sentinel.vxd.</I>
<BR><B>-Misc.:</B>
<BR>The DOS .exe file Does NOT run if no dongle detected. InstallShield
password protected.

<P><TT>Crackers are very serious peoples, look: we are going to crack a
dongle protected cellular electrochemical dynamics simulator! Nice isn't
it? But don't worry, as usual the program is far more complicated to understand
than its dongle protection is.</TT>

<P><TT>Before downloading it, I read at Axon's home page the following:</TT>
<BR><TT>"<I>If you are not currently a licensed user of Axon Engineer,
the downloads below will be of no use to you since they require the presence
of a hardware key ('dongle') to run.</I></TT>
<BR><TT><I>If you are a licensed user of Axon Engineer Pro, you will need
a password to run the setup program for the upgrade.</I>"</TT>
<BR>&nbsp;

<P><TT>The setup (that stupid InstallShield Wizard) is protected with a
password. A simple BPX Lstrcmp will show you that you should better type
<I>'opengate1' </I>if you ever want to have the opportunity to install
this soft.</TT>

<P><TT>There are 2 .exe files:</TT>
<BR><TT>- aewin.exe (375Kb) for Window$</TT>
<BR><TT>- eapro.exe (400Kb) for DOS.</TT>

<P><TT>Strangely, the Windows' file doesn't seem to require any dongle
(or did I miss something??) but the DOS'one does. That's just because it
is much more sophisticated than <I>aewin.exe</I> which doesn't appear to
be able to create new file.</TT>
<BR><TT>Let's work on the DOS app. For this I would prefer to use Sourcer
7.0 but since +IDA Pro is an official +HCU tool we will use it for this
crack.</TT>

<P><TT>Running <I>eapro.exe</I> will display the following message (and
nearly crash your computer, BTW -:):</TT>
<BR><I><TT>'Hardware Key Violation'</TT></I>

<P><TT>Open it with IDA Pro and search for the string "key":</TT>
<BR><TT>&nbsp;&nbsp; ALT-B&nbsp;&nbsp;&nbsp;&nbsp; type=>&nbsp;&nbsp; "key"</TT>

<P><TT>IDA send you there:</TT>

<P><TT>dseg:019E aHardwareKeyVio db 'Hardware Key Violation',0 ; DATA XREF:
sub_0_0+1347</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Just click on the XREF:</TT>

<P><TT>000:1346 loc_0_1346:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; CODE XREF: sub_0_0+35B</TT>
<BR><TT>000:1346&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp;&nbsp; ds</TT>
<BR><TT>000:1347&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp;&nbsp; <B>offset aHardwareKeyVio</B></TT>
<BR><TT>000:134A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp;&nbsp; 0FFFFh</TT>
<BR><TT>000:134C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp;&nbsp;&nbsp; sub_D49_2</TT>
<BR><TT>000:1351&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp;&nbsp; sp, 6</TT>
<BR><TT>000:1354&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp;&nbsp;&nbsp; short loc_0_13A0</TT>

<P><TT>As there is only 1 XREF, click on it again&nbsp; and you'll get
what you were looking for:</TT>

<P><TT>000:034C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp;&nbsp; ds</TT>
<BR><TT>000:034D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp;&nbsp; offset aAxonEngineer</TT>
<BR><TT>000:0350&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp;&nbsp;&nbsp; sub_DED_28A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check_Dongle</FONT></TT>
<BR><TT>000:0355&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp;&nbsp; sp, 4</TT>
<BR><TT>000:0358&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp;&nbsp; ax, 2231h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK?</FONT></TT>
<BR><TT>000:035B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jnz&nbsp;&nbsp;&nbsp;&nbsp; loc_0_1346&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;
; Bad_Guy_jump</FONT></TT>
<BR><TT>000:035F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
imul&nbsp;&nbsp;&nbsp; bx, [bp+var_10], 46h</TT>

<P><TT>Here again, there's no need to tell you how to crack it.</TT>

<P>
<HR WIDTH="100%">

<P><B><U><FONT SIZE=+2>FTI/DOE v2.3.1.4</FONT></U></B>
<BR><B>-Description:</B>
<BR>Tools for performing the process of dynamic energy analysis.
<BR><B>-OS:</B>
<BR>DOS/Win3.xx/Win95/NeXTStep/VMS and most Unix systems.
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: <I>none.</I>
<BR><B>-Misc.:</B>
<BR>The 2 main DOS .exe files do NOT run if no dongle detected
<BR>&nbsp;

<P><TT>For infos, here is the more complete description of this soft:</TT>
<BR><TT>'<I>This software enables architects and engineers to perform a
comprehensive analysis of dynamic heating and cooling loads, simulation
of heating and cooling distribution systems, modeling of equipment supplying
the required energy and calculation of the life-cycle costs of owning and
operating energy systems for buildings. The program can simulate hour-by-hour
performance for buildings ranging in size from a small one-room residence
to a large multi-storied structure for each of the 8760 hours in a year.</I></TT>
<BR><TT><I>FTI/DOE is based on the work conducted by the Simulation Research
Group at Lawrence Berkeley Laboratories (LBL).</I>'</TT>

<P><TT>I really have no use of this soft, but as this DOS app was written
in Fortran and as I like this language, I downloaded it. If you never saw
the source code of a file in Fortran, you can go to <A HREF="tppmsgs/msgs4.htm#456" tppabs="http://www.finite-tech.com/download.html">FTI/DOE
site</A> and download the source of one of the .exe of this program (the
'weather processor' file - <I>wth.exe</I>) and you'll see how beautiful
it looks!</TT>

<P><TT>The 2 main softs (<I>ble.exe</I> 1Mb and <I>sim.exe</I> 1.57Mb)
are dongle protected (own routines linked inside both programs) and will
display the following message:</TT>

<P><TT>'<I>Invalid Hardware Key or Key Error</I></TT>
<BR><I><TT>Check the key for proper installation</TT></I>
<BR><TT><I>...Exiting!!!</I>'</TT>

<P><TT>We will only have a look at <I>ble.exe</I> as both program use exactly
the same protection scheme.</TT>

<P><TT>BPIO -h 378 with SoftICE and run it. SoftICE pops, then &lt;P RET>
2 times and here we go:</TT>

<P><TT>0002B285: E873EBFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp;&nbsp; 000029DFD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
get dongle RetCode in ax</FONT></TT>
<BR><TT>0002B28A: 8BE5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; esp,ebp</TT>
<BR><TT>0002B28C: 25F0FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
and&nbsp;&nbsp;&nbsp; eax,0FFFFFFF0</TT>
<BR><TT>0002B291: 663B0500560800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; ax,[000085600]&nbsp;&nbsp; <FONT COLOR="#3333FF">;
compare to correct RetCode (0x8010)</FONT></TT>
<BR><TT>0002B298: 6693&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xchg&nbsp;&nbsp; bx,ax</TT>
<BR><TT>0002B29A: 0F8502000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp;&nbsp; 00002B2A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>0002B2A0: 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; eax,eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Clear ax for Good_Guy</FONT></TT>
<BR><TT>0002B2A2: 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; edx</TT>
<BR><TT>0002B2A3: 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; ecx</TT>
<BR><TT>0002B2A4: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; ebx</TT>
<BR><TT>0002B2A5: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn</TT>

<P><TT>A couple of &lt;P RET> later we have:</TT>

<P><TT>00032393: E88DB30300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp;&nbsp; 00006D725&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; the caller</FONT></TT>
<BR><TT>00032398: 83C40C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; esp,00C</TT>
<BR><TT>0003239B: F705E41C090001000000&nbsp; test&nbsp;&nbsp; d,[000091CE4],000000001</TT>
<BR><TT>000323A5: 753E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp;&nbsp; 0000323E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; make it always jump</FONT></TT>

<P><TT>Again I just can't believe it: those guys wrote a sophisticated
soft, powerful and reliable with a complicated language (Fortran) but were
just unable to write a good protection scheme!</TT>
<BR>&nbsp;

<P><TT>If you run it now, you'll get:</TT>
<BR><TT>'<I>Fortran runtime error on external file "C:\xxxxxx\xxxxxx\xxxxxx\input2.tmp"
(1046):</I></TT>
<BR><TT><I>Attempt to open non-existing file with STATUS = OLD</I>'</TT>
<BR><TT>This error message is just due to the fact that the soft doesn't
run without command line arguments (see the batch files in the <I>Script</I>
directory if you plan to use this soft).</TT>
<BR>&nbsp;
<BR>&nbsp;
<BR>&nbsp;

<P>
<HR WIDTH="100%">

<P><B><U><FONT SIZE=+2>S-Tagger for FrameMaker v2.0</FONT></U></B>
<BR><B>-Description:</B>
<BR>Tools for extracting text from MIF files created with Adobe FrameMaker
5.xx.
<BR><B>-OS:</B>
<BR>Win95/NT3.51 (with Service Pack 2 or later installed)/NT 4.0 and Windows
3.x (with Win32s).
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: <I>ACTIVATOR &amp; UniKey</I> (SSIACT.386
for Win95/3.xx and SSIPDDP.SYS&nbsp; for WinNT).
<BR><B>-Misc.:</B>
<BR>Run in DEMO mode if NO dongle detected (see below).
<BR><TT>&nbsp;</TT>

<P><TT>If no dongle is connected, the program will run in demo mode with
the following limitations:</TT>
<BR><TT>'<I>The demonstration version is a full working version of The
S-Tagger for FrameMaker, with the limitation that only files of a particular
size, up to 180KB for MIF files and 30KB for STF/RTF files, can be processed.</I>'</TT>

<P><TT>Running it will display a message box:</TT>
<BR><TT>'<I>While no dongle is connected to the parallel port, the program
only runs in Demo mode</I>.'</TT>
<BR>&nbsp;
<BR><TT>Disasm the main file (<I>staggerf.exe</I> 650Kb) :</TT>

<P><TT>We can quickly find the '<I>While no dongle</I>...' string data
ref:</TT>

<P><TT>:004047B6 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001</TT>
<BR><TT>:004047B8 E8A3F6FFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00403E60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check Dongle</FONT></TT>
<BR><TT>:004047BD 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:004047BF 7544&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00404805&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>
<BR><TT>:004047C1 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001</TT>
<BR><TT>:004047C3 8D4DC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebp-38]</TT>
<BR><TT>:004047C6 6A05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000005</TT>
<BR><TT>:004047C8 E893F6FFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00403E60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check Dongle</FONT></TT>
<BR><TT>:004047CD 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:004047CF 7534&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00404805&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>
<BR><TT>:004047D1 8D4DE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebp-1C]</TT>
<BR><TT>:004047D4 E8237B0400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0044C2FC</TT>
<BR><TT>:004047D9 68BE000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 000000BE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; 'While no dongle is connected...'</FONT></TT>

<P><TT>The program check the dongle by calling twice the routine located
at offset :00403E60. I don't know a lot about the Activator dongle, but
it seems to be similar with the Hasp dongle as, each time it calls this
routine, we can see the parameter pushed on the stack push 1, push 5 that
could be 'check_if_dongle_present' and 'type of dongle' but I am not sure.</TT>

<P><TT>When running, S-Tagger displays the <I>About</I> thumbnail where
we can read:</TT>
<BR><TT>'<I>The S-Tagger 2.0 for FrameMaker is running in Demo mode</I>'</TT>
<BR><TT>Searching again in the String data refs, we find 2 locations but
only one is interesting:</TT>

<P><TT>:0042F9FE 687A170000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0000177A&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; '%s is running
in'</FONT></TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>:0042FA42 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001</TT>
<BR><TT>:0042FA44 E81744FDFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00403E60</TT>
<BR><TT>:0042FA49 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:0042FA4B 7436&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 0042FA83</TT>
<BR><TT>:0042FA4D 6898170000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00001798&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; 'comprehensive
mode.'</FONT></TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>:0042FAC7 EB21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 0042FAEA</TT>

<P><TT>* Referenced by a Jump at Address:0042FA91(C)</TT>
<BR><TT>:0042FAC9 688E170000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0000178E&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; 'demo mode.'</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Again, it calls the same routine (:00403E60). We can see that it
will run either in 'demo mode' or in 'comprehensive mode'.</TT>
<BR><TT>Let's have a look at this routine:</TT>

<P><TT>* Referenced by a CALL at Addresses:004047B8, :004047C8, :0040756D,
:0040757D, :00417EF8, :00417F08, :00417F9B, :00417FAB, :0042E6AD, :0042FA44,
:0042FA8A</TT>

<P><TT>:00403E60 807C240474&nbsp;&nbsp; cmp byte ptr [esp+04], 74&nbsp;
<FONT COLOR="#3333FF">; check last 'push xxxxxxxx'</FONT></TT>
<BR><TT>:00403E65 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ebx</TT>
<BR><TT>:00403E66 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push esi</TT>
<BR><TT>:00403E67 8BF1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, ecx</TT>
<BR><TT>:00403E69 733F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jnb 00403EAA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jnb Bad_Guy#2&nbsp;&nbsp; **Change to jmp 00403E89**</FONT></TT>
<BR><TT>:00403E6B 8A5C2410&nbsp;&nbsp;&nbsp;&nbsp; mov bl, byte ptr [esp+10]</TT>
<BR><TT>:00403E6F 80FB01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp bl, 01</TT>
<BR><TT>:00403E72 7236&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jb 00403EAA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jb Bad_Guy~2</FONT></TT>
<BR><TT>:00403E74 80FB08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp bl, 08</TT>
<BR><TT>:00403E77 7731&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ja 00403EAA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; ja Bad_Guy#2</FONT></TT>
<BR><TT>:00403E79 E882000000&nbsp;&nbsp; call 00403F00</TT>
<BR><TT>:00403E7E 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:00403E80 7507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00403E89&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jne Good_Guy</FONT></TT>
<BR><TT>:00403E82 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy#1</FONT></TT>
<BR><TT>:00403E84 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00403E85 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00403E86 C20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0008</TT>

<P><TT>* Referenced by a Jump at Address:00403E80(C)</TT>
<BR><TT>:00403E89 8B44240C&nbsp;&nbsp;&nbsp;&nbsp; mov eax, dword ptr [esp+0C]</TT>
<BR><TT>:00403E8D 8BCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, esi</TT>
<BR><TT>:00403E8F 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax</TT>
<BR><TT>:00403E90 E88BFFFFFF&nbsp;&nbsp; call 00403E20</TT>
<BR><TT>:00403E95 B201&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dl, 01</TT>
<BR><TT>:00403E97 8D4BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ecx, dword
ptr [ebx-01]</TT>
<BR><TT>:00403E9A D2E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl dl, cl</TT>
<BR><TT>:00403E9C 22D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
and dl, al</TT>
<BR><TT>:00403E9E 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00403E9F 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00403EA0 80FA01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp dl, 01</TT>
<BR><TT>:00403EA3 1BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sbb eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; eax= -1</FONT></TT>
<BR><TT>:00403EA5 F7D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
neg eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; set Good_Guy flag</FONT></TT>
<BR><TT>:00403EA7 C20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0008</TT>

<P><TT>* Referenced by a Jump at Addresses:00403E69(C), :00403E72(C), :00403E77(C)</TT>
<BR><TT>:00403EAA 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy#2</FONT></TT>
<BR><TT>:00403EAC 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00403EAD 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00403EAE C20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0008</TT>

<P><TT>Obviously, patching the <I>jnb Bad_Guy#2</I> is enough to a have
a full working version ('comprehensive mode').</TT>
<BR><TT>There are two calls to offsets :00403F00 and :00403E20. Here is
the code for the first one:</TT>

<P><TT>:00403F00 83EC04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub esp, 00000004</TT>
<BR><TT>:00403F03 8D442402&nbsp;&nbsp;&nbsp;&nbsp; lea eax, dword ptr [esp+02]</TT>
<BR><TT>:00403F07 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax</TT>
<BR><TT>:00403F08 E8B3FFFFFF&nbsp;&nbsp; call 00403EC0</TT>
<BR><TT>:00403F0D 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:00403F0F 752B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00403F3C</TT>
<BR><TT>:00403F11 6A3A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0000003A</TT>

<P><TT>* Reference To: W32SSI.wSSIMemR, Ord:0015h</TT>
<BR><TT>:00403F13 E8A8410300&nbsp;&nbsp; Call 004380C0</TT>
<BR><TT>:00403F18 3D6E610000&nbsp;&nbsp; cmp eax, 0000616E</TT>
<BR><TT>:00403F1D 7517&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00403F36</TT>
<BR><TT>:00403F1F 6A3B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 0000003B</TT>

<P><TT>* Reference To: W32SSI.wSSIMemR, Ord:0015h</TT>
<BR><TT>:00403F21 E89A410300&nbsp;&nbsp; Call 004380C0</TT>
<BR><TT>:00403F26 3D00210000&nbsp;&nbsp; cmp eax, 00002100</TT>
<BR><TT>:00403F2B 7509&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00403F36</TT>
<BR><TT>:00403F2D B801000000&nbsp;&nbsp; mov eax, 00000001</TT>
<BR><TT>:00403F32 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add esp, 00000004</TT>
<BR><TT>:00403F35 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>

<P><TT>* Referenced by a Jump at Addresses:00403F1D(C), :00403F2B(C)</TT>
<BR><TT>:00403F36 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT>:00403F38 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add esp, 00000004</TT>
<BR><TT>:00403F3B C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>

<P><TT>* Referenced by a Jump at Address:00403F0F(C)</TT>
<BR><TT>:00403F3C B801000000&nbsp;&nbsp; mov eax, 00000001</TT>
<BR><TT>:00403F41 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add esp, 00000004</TT>
<BR><TT>:00403F44 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>

<P><TT>Nothing to explain here, everything is clear again: <I>W32ssi.dll</I>
is the DLL that will check for your dongle by calling its driver.</TT>
<BR><TT>I was just wondering if this 'comprehensive mode' was the full
version, so I created a 300Kb MIF file with FrameMaker 5.5 and converted
it with S-Tagger without any problem and the program works well.</TT>
<BR>&nbsp;

<P>
<HR WIDTH="100%">

<P><B><U><FONT SIZE=+2>XinTianMa C</FONT></U></B>
<BR><B>-Description:</B>
<BR>CJK (Chinese-Japanese-Korean) language software for word processing
and viewing of CJK encoded web pages for E-Windows 95/3.1, C-Windows (Traditional
&amp; Simplified), J-Windows and DOS.
<BR><B>-OS:</B>
<BR>Win95/Win3.xx/DOS.
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: unknown (internal).
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected.

<P><TT>If you ever get connected to XinTianMa's site, you'll be surprised
to read on top of each page:</TT>
<BR><TT>'<I>This page generated by an evaluation copy of the Microsoft
Merchant Server</I>.'</TT>
<BR><TT>Ohhh, Naughty boys...</TT>

<P><TT>This DOS tool doesn't use any external dongle driver, but its own
one linked inside the main .exe : <I>xtmg.exe</I> 413Kb. Only this file
is protected.</TT>
<BR><TT>Running it will display the following message: '<I>error : XTMG
requires dongle.</I>'</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>&nbsp;Bpio -h 378 and SoftICE pops here:</TT>

<P><TT>00018939: 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc&nbsp;&nbsp;&nbsp; dx</TT>
<BR><TT>0001893A: 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc&nbsp;&nbsp;&nbsp; dx</TT>
<BR><TT>0001893B: EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
in&nbsp;&nbsp;&nbsp;&nbsp; al,dx</TT>
<BR><TT>0001893C: 8AE0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ah,al</TT>
<BR><TT>0001893E: 0C04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
or&nbsp;&nbsp;&nbsp;&nbsp; al,004</TT>
<BR><TT>00018940: 24BF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
and&nbsp;&nbsp;&nbsp; al,0BF</TT>
<BR><TT>00018942: EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
out&nbsp;&nbsp;&nbsp; dx,al</TT>
<BR><TT>00018943: 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; cx</TT>
<BR><TT>00018944: 8B0E7822&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
cx,[02278]</TT>
<BR><TT>00018948: E2FE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
loop&nbsp;&nbsp; 000018948</TT>
<BR><TT>0001894A: 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; cx</TT>
<BR><TT>0001894B: 4A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dec&nbsp;&nbsp;&nbsp; dx</TT>
<BR><TT>0001894C: 4A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dec&nbsp;&nbsp;&nbsp; dx</TT>
<BR><TT>0001894D: B0FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; al,0FF</TT>
<BR><TT>0001894F: EE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
out&nbsp;&nbsp;&nbsp; dx,al</TT>
<BR><TT>........</TT>
<BR><TT>There's another similar one located elsewhere in the program. Both
routines are called alternatively. The reason is that the program will
search for 2 different RetCodes.</TT>
<BR>&nbsp;

<P><TT>3 <I>pret</I> later, we land in the middle of this routine:</TT>

<P><TT>00018611: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; bp</TT>
<BR><TT>00018612: 8BEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; bp,sp</TT>
<BR><TT>00018614: 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; di</TT>
<BR><TT>00018615: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; si</TT>
<BR><TT>00018616: 8B7E06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
di,[bp][00006]</TT>
<BR><TT>00018619: C706F040C96E&nbsp; mov&nbsp;&nbsp;&nbsp; w,[040F0],<FONT COLOR="#CC0000">06EC9</FONT>&nbsp;
<FONT COLOR="#3333FF">; Store correct RetCode#1 in [40F0]</FONT></TT>
<BR><TT>0001861F: C706F2404B3F&nbsp; mov&nbsp;&nbsp;&nbsp; w,[040F2],<FONT COLOR="#CC0000">03F4B</FONT>&nbsp;
<FONT COLOR="#3333FF">; Store correct RetCode#2 in [40F2]</FONT></TT>
<BR><TT>00018625: 0BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
or&nbsp;&nbsp;&nbsp;&nbsp; di,di&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it the first time we get here?</FONT></TT>
<BR><TT>00018627: 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp;&nbsp; 00001863B</TT>
<BR><TT>00018629: 6A29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; 029</TT>
<BR><TT>0001862B: FF363C22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
w,[0223C]</TT>
<BR><TT>0001862F: FF363A22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
w,[0223A]</TT>
<BR><TT>00018633: 9A1E001725&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp; 02517:0001E</TT>
<BR><TT>00018638: 83C406&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;
sp,006</TT>
<BR><TT>0001863B: 2BF6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub&nbsp;&nbsp;&nbsp; si,si</TT>
<BR><TT>0001863D: 3BF7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; si,di&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Have both RetCodes been checked and OKayed?</FONT></TT>
<BR><TT>0001863F: 7327&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jae&nbsp;&nbsp;&nbsp; 000018668&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp to Good_Guy</FONT></TT>
<BR><TT>00018641: 1E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; ds</TT>
<BR><TT>00018642: 683E22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
0223E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Prepare welcome message...</FONT></TT>
<BR><TT>00018645: 0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; cs</TT>
<BR><TT>00018646: E8A7FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
0000185F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Check // port for dongle</FONT></TT>
<BR><TT>00018649: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bx</TT>
<BR><TT>0001864A: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bx</TT>
<BR><TT>0001864B: 3B06F040&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;
ax,[040F0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Check if RetCode#1 OK</FONT></TT>
<BR><TT>0001864F: 7513&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp;&nbsp; 000018664&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; If not, jump and try again</FONT></TT>
<BR><TT>00018651: 1E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; ds</TT>
<BR><TT>00018652: 685722&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
02257&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Prepare copyright message...</FONT></TT>
<BR><TT>00018655: 0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; cs</TT>
<BR><TT>00018656: E897FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
0000185F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Check // port for dongle</FONT></TT>
<BR><TT>00018659: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bx</TT>
<BR><TT>0001865A: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bx</TT>
<BR><TT>0001865B: 3B06F240&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;
ax,[040F2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Check if RetCode#2 OK</FONT>&nbsp;</TT>
<BR><TT>0001865F: 7503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp;&nbsp; 000018664&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; If not, jump and try again</FONT></TT>
<BR><TT>00018661: 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc&nbsp;&nbsp;&nbsp; si&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; inc Check_Dongle counter</FONT></TT>
<BR><TT>00018662: EBD9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp;&nbsp; 00001863D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
jmp back</FONT></TT>
<BR><TT>00018664: 2BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy (clear ax)</FONT></TT>
<BR><TT>00018666: EB03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp;&nbsp; 00001866B</TT>
<BR><TT>00018668: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Set Good_Guy flag</FONT></TT>
<BR><TT>0001866B: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; si</TT>
<BR><TT>0001866C: 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; di</TT>
<BR><TT>0001866D: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>0001866E: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Back to caller</FONT></TT>

<P><TT>0001866F: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; bp</TT>
<BR><TT>00018670: 8BEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; bp,sp</TT>
<BR><TT>00018672: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; si</TT>
<BR><TT>00018673: BE0100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
si,00001</TT>
<BR><TT>00018676: 83FE04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;
si,004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check_Dongle counter =&lt;4 ?</FONT></TT>
<BR><TT>00018679: 7720&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ja&nbsp;&nbsp;&nbsp;&nbsp; 00001869B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp to Bag_Guy if >=5</FONT></TT>
<BR><TT>0001867B: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; si</TT>
<BR><TT>0001867C: 9A1B003215&nbsp;&nbsp; call&nbsp;&nbsp; 01532:0001B -</TT>
<BR><TT>00018681: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bx</TT>
<BR><TT>00018682: 0BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
or&nbsp;&nbsp;&nbsp;&nbsp; ax,ax</TT>
<BR><TT>00018684: 740C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp;&nbsp; 000018692&nbsp;&nbsp; -</TT>
<BR><TT>00018686: FF7606&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
w,[bp][00006]</TT>
<BR><TT>00018689: 0E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; cs</TT>
<BR><TT>0001868A: E884FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
000018611&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Call previous routine</FONT></TT>
<BR><TT>0001868D: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bx</TT>
<BR><TT>0001868E: 0BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
or&nbsp;&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it OK?</FONT></TT>
<BR><TT>00018690: 7503&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp;&nbsp; 000018695&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp Good_Guy</FONT></TT>
<BR><TT>00018692: 46&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
inc&nbsp;&nbsp;&nbsp; si&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; inc Check_Dongle counter</FONT></TT>
<BR><TT>00018693: EBE1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp;&nbsp; 000018676&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp back</FONT> <FONT COLOR="#3333FF">and try your
luck again.</FONT></TT>
<BR><TT>00018695: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Set Good_Guy flag...</FONT></TT>
<BR><TT>00018698: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; si</TT>
<BR><TT>00018699: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>0001869A: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retf</TT>
<BR><TT>0001869B: 2BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy flag</FONT></TT>
<BR><TT>0001869D: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; si</TT>
<BR><TT>0001869E: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>0001869F: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retf</TT>
<BR><TT>...</TT>
<BR><TT>000186F8: E874FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;
00001866F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Call the above routine</FONT></TT>
<BR><TT>000186FB: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; bx</TT>
<BR><TT>000186FC: 0BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
or&nbsp;&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Dongle or no dongle ?</FONT></TT>
<BR><TT>000186FE: 7521&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp;&nbsp; 000018721</TT>
<BR><TT>...</TT>
<BR><TT>00018721: B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
found it, go ahead</FONT></TT>
<BR><TT>00018724: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retf</TT>
<BR><TT>0001869B: 2BC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub&nbsp;&nbsp;&nbsp; ax,ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; otherwise clear ax and exit</FONT></TT>
<BR><TT>0001869D: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; si</TT>
<BR><TT>0001869E: C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>0001869F: CB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retf</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>The program check the RetCode#1 and, if it is not correct, will
check it again 3 times. After that, if it is still the wrong RetCode you
are sent away otherwise it will do the same job for the RetCode#2.</TT>
<BR><TT>The stupid part of this code is when the program stores the 2 correct
RetCodes, and the fact that everything is located in same area. Hard to
miss it!</TT>
<BR><TT>As there are at least one dozen different ways to patch and crack
this, I let you decide which one you prefer, there's no need to explain
this.</TT>

<P>
<HR WIDTH="100%">

<P><A NAME="OmniMark"></A><B><U><FONT SIZE=+2>OmniMark v3R1a Win95</FONT></U></B>
<BR><B>-Description:</B>
<BR>Perform large-scale conversion and mark-up of text and data for delivery
in print or on CD-ROM, as well as allow Intranet and website builders to
automate the presentation of individualized content
<BR><B>-OS:</B>
<BR>Win95 (there are other versions for DOS/Win3.XX, NT, OS/2).
<BR><B>-Protection:</B>
<BR>Dongle (parallel ). Driver: <I>Hasp95.vxd</I>.
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected.

<P><TT>This 32bit app will run in a DOS box. I tried it and it appears
to be fast and very efficient.</TT>

<P><TT>That's another Hasp dongle! Let's bash it too.</TT>
<BR><TT>With Hiew, we can quickly locate the main hasp routine in the main
executable (<I>omnimark.exe</I> 1.5Mb): 00133548 (:00533548 with SoftICE
or W32Dasm).</TT>
<BR><TT>Running the program will display:</TT>
<BR><TT>'<I>Authorization failed. Exiting OmniMark.</I>'</TT>

<P><TT>Though it's just another stupid protection, I add it here for 2
reasons:</TT>
<BR><TT>1) though I cracked several Hasp protected softs, this is the first
one I found that will clear eax for the Good_Guy and set it to 1 for the
Bad_Guy:</TT>

<P><TT>:0041104A 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001</TT>
<BR><TT>:0041104C E8F7241200&nbsp;&nbsp;&nbsp; call 00533548&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Call Hasp Service#1</FONT></TT>
<BR><TT>:00411051 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add
esp, 00000024</TT>
<BR><TT>:00411054 837DFC00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp dword ptr
[ebp-04], 00000000 <FONT COLOR="#3333FF">; Is it a Hasp (RetCode#1 should
be =0x01)</FONT></TT>
<BR><TT>:00411058 0F850A000000&nbsp; jne 00411068&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>
<BR><TT>:0041105E B801000000&nbsp;&nbsp;&nbsp; mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Set Bad_Guy_Flag</FONT></TT>
<BR><TT>:00411063 E9A6020000&nbsp;&nbsp;&nbsp; jmp 0041130E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; terminate</FONT></TT>
<BR><TT>The first time I ran it, I just put a BPX on the main Hasp routine,
get back to the caller and make it jump (as usual) until the <I>mov eax,1</I>
at the end of this routine and.. got this 'Authorization failed' message.</TT>

<P><TT>2) one tip, that works sometimes, is to search for some ofently
used instructions like the <I>Jmp Next_Instruction</I> (0xe90000000)located
at the end of the main routine that will call the dongle routine. It is
useless and only used instead of 5 <I>nop</I>:</TT>

<P><TT>:00410BD1 E8AA030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00410F80</TT>
<BR><TT>:00410BD6 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000004</TT>
<BR><TT>:00410BD9 <FONT COLOR="#CC0000">E900000000</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 00410BDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; useless</FONT></TT>
<BR><TT>:00410BDE 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</TT>
<BR><TT>:00410BDF 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00410BE0 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00410BE1 C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>:00410BE2 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>:004112EA 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:004112EC 0F8412000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00411304</TT>
<BR><TT>:004112F2 8B45E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [ebp-20]</TT>
<BR><TT>:004112F5 A34C2C5600&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [00562C4C], eax</TT>
<BR><TT>:004112FA C7059C3E56009A1F4100&nbsp;&nbsp;&nbsp; mov dword ptr
[00563E9C], 00411F9A</TT>
<BR><TT>:00411304 B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000001</TT>
<BR><TT>:00411309 <FONT COLOR="#CC0000">E900000000</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 0041130E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; useless</FONT></TT>
<BR><TT>:0041130E 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</TT>
<BR><TT>:0041130F 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00411310 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00411311 C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
leave</TT>
<BR><TT>:00411312 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR>&nbsp;
<BR>&nbsp;
<BR>&nbsp;

<P><TT>Well, that's all to say about this soft, because if you disasm it
and have a look in the String data refs, you'll get:</TT>

<P><TT>:004018ED E828F30000&nbsp;&nbsp;&nbsp; call 00410C1A</TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<TT><FONT COLOR="#3333FF">; Check dongle</FONT></TT>
<BR><TT>:004018F2 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</TT>
<BR><TT>:004018F4 0F8512000000&nbsp; jne 0040190C</TT>
<BR><TT>:004018FA 687C115400&nbsp;&nbsp;&nbsp; push 0054117C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; 'Authorization failed. Exiting OmniMark'.</FONT></TT>
<BR><TT>:004018FF E894F20000&nbsp;&nbsp;&nbsp; call 00410B98</TT>
<BR><TT>:00401904 83C404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add
esp, 00000004</TT>
<BR><TT>:00401907 E864F20000&nbsp;&nbsp;&nbsp; call 00410B70</TT>
<BR><TT>:0040190C E92F000000&nbsp;&nbsp;&nbsp; jmp 00401940</TT>

<P><TT>No comments here as well about how to crack it...</TT>
<BR>&nbsp;

<P>
<HR WIDTH="100%">
<BR>
<HR WIDTH="100%">
<BR>&nbsp;

<P><TT>And now, just for the fun, as I started my essay with Aladdin informations
and tips about 'how_to_protect_better_your_soft_with_our_state_of_the_art_dongle',
I though it may be worth having a quick look at one of the free tools you
can get on their site: <I>Haptest.exe</I></TT>
<BR><TT>Description:</TT>
<BR><I><TT>'Hasptest is a simple program that checks the existency of FotoWare
protection dongles. It will report the different dongles found on your
system. This can be used to check that all dongles are found, and that
they are working properly.'</TT></I>
<BR>&nbsp;

<P><TT>Here is just one piece of code from this 60Kb .exe file (all other
calls to the dongle are strictly similar):</TT>

<P><TT>:00401BD6 6A02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000002</TT>
<BR><TT>:00401BD8 E823F4FFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00401000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Hasp routine service #2</FONT></TT>
<BR><TT>:00401BDD 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000024</TT>
<BR><TT>:00401BE0 817C240867B80000&nbsp; cmp dword ptr [esp+08], 0000B867&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is RetCode1=0xB867 ?</FONT></TT>
<BR><TT>:00401BE8 752C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>:00401BEA 817C240C964D0000&nbsp; cmp dword ptr [esp+0C], 00004D96&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is RetCode2=0x4D96 ?</FONT></TT>
<BR><TT>:00401BF2 7522&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>:00401BF4 817C241098BD0000&nbsp; cmp dword ptr [esp+10], 0000BD98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is RetCode3=0xBD98 ?</FONT></TT>
<BR><TT>:00401BFC 7518&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>:00401BFE 817C2414366A0000&nbsp; cmp dword ptr [esp+14], 00006A36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is RetCode4=0x6A36 ?</FONT></TT>
<BR><TT>:00401C06 750E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00401C16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>:00401C08 6A40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000040&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT>:00401C0A 6838514000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00405138&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; 'HASP TEST'</FONT></TT>
<BR><TT>:00401C0F 68C0504000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 004050C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; 'FotoSync CSF HASP found'</FONT></TT>
<BR><TT>:00401C14 EB0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 00401C22</TT>
<BR><TT>:00401C16 6A10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000010&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; 'HASP TEST'</FONT></TT>
<BR><TT>:00401C18 6838514000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00405138&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; '** NO FotoSync CSF HASP found **'</FONT></TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>Well, since they advise programmers to better protect their softs,
I thought they might have taken this opportunity to do the same with their
own programs...</TT>
<BR>&nbsp;

<P><TT>That's all.</TT>
<BR><TT>If I don't get a 'Dongle overdose' within the next few hours, and
if I am smart enough, I may go and try to fetch all free dongle softs available
on the Net, put them in a list and mail it to +Fravia for the +HCU.</TT>
<BR>&nbsp;
<hr><center><i>OK, he did it: <a href="donglink.htm" tppabs="http://ftp.fravia.org/donglink.htm">here it is</a></i></center><hr>


<P><TT>Frog's Print - January 29, 1998</TT>


<!-- OB DUH STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT></center><bR>
</td></tr></table>
 <center>
   <i>I wont even bother explaining you 
   that you should BUY the relevant target programs if you intend to use them 
 for non-study purposes. Should you want 
   to STEAL this software instead, you don't need to crack its protection 
   scheme at all: you'll 
   find it on most Warez sites, complete and already regged, farewell.</i>
</center>

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside fravia's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<!-- EITHER A NICE GIF -->


<a href="advanced.htm" tppabs="http://ftp.fravia.org/advanced.htm"><IMG SRC="xtranio.gif" tppabs="http://ftp.fravia.org/xtranio.gif" 
ALT="advanced" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>

<font color=gray>Back to advanced cracking</FonT><bR>
<br>



<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://ftp.fravia.org/index.html">homepage</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://ftp.fravia.org/links.htm">links</A> 
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://ftp.fravia.org/noanon.htm">anonymity</A> 
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://ftp.fravia.org/orc.htm">+ORC</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://ftp.fravia.org/student.htm">students' essays</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://ftp.fravia.org/academy.htm">academy database</A>
<br>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://ftp.fravia.org/tools.htm">tools</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://ftp.fravia.org/javascri.htm">javascript wars</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://ftp.fravia.org/cocktail.htm">cocktails</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tppmsgs/msgs1.htm#137" tppabs="http://fravia.org/ideale.htm">antismut CGI-scripts</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://ftp.fravia.org/searengi.htm">search_forms</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://ftp.fravia.org/info.htm">mail_fravia+</A>
<br>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://ftp.fravia.org/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>

</BODY>
</HTML>